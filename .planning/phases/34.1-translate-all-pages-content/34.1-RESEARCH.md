# Phase 34.1: Translate All Pages & Content - Research

**Researched:** 2026-01-20
**Domain:** Hardcoded string extraction and translation completion
**Confidence:** HIGH

## Summary

This phase is a cleanup effort to translate remaining hardcoded English strings discovered after Phase 34 (Language Switcher & Polish). The primary issues are:
- GlobalSearchBar and InvestorSearchBar were recently translated (commits show this was done)
- However, many other components still have hardcoded strings that weren't caught during Phase 31's translation infrastructure work

Key findings:
- **~100 components exist** in `/src/components`, of which **~73 use `useTranslations`**
- **~27 components** still have hardcoded English strings and need translation
- Primary categories needing translation:
  1. **Chat components**: Dialogs, selectors, role labels
  2. **Notifications component**: Header, empty states, loading
  3. **Feed components**: PropertySelector, RepostDialog
  4. **Profile/Form components**: ProviderProfileForm placeholders
  5. **Utility components**: MortgageCalculator labels

**Primary recommendation:** Systematically add `useTranslations` to remaining components, adding keys to existing namespaces in en.json/he.json. Focus on user-visible strings only (skip developer-facing error logs).

## Standard Stack

### Core
| Library | Version | Purpose | Why Standard |
|---------|---------|---------|--------------|
| next-intl | ^4.x | Translation hooks | Already installed, used throughout app |
| useTranslations | N/A | Client component translations | Standard pattern from Phase 31 |
| useFormatter | N/A | Number/date formatting | For currency, dates (already used) |

### Existing Translation Structure
```
messages/
├── en.json    # ~1800 lines, fully structured
└── he.json    # ~1800 lines, Hebrew translations
```

Namespaces already defined:
- `common` (actions, status, labels, errors, propertyTypes, roles, amenities)
- `navigation` (groups, items)
- `dashboard`, `settings`, `clients`, `analytics`
- `properties` (card, details, form, filters, empty, save, saved, neighborhood)
- `deals` (stages, card, detail, providers, files, activity, questionnaire)
- `chat` (title, modes, input, layout, pane, participants, group, empty, time)
- `feed` (title, tabs, filters, post, engagement, comments, share, follow, empty)
- `search` (title, placeholder, tabs, results, quickActions, trending)
- `providers`, `profile`, `onboarding`, `misc`, `header`, `breadcrumbs`

## Architecture Patterns

### Pattern 1: Add Translations to Existing Component
**What:** Import `useTranslations`, replace hardcoded strings
**When:** Component has user-visible English text

```typescript
// Before
export function NotificationCenter() {
  return (
    <h3 className="font-semibold text-sm">Notifications</h3>
  );
}

// After
import { useTranslations } from "next-intl";

export function NotificationCenter() {
  const t = useTranslations("common"); // or appropriate namespace
  return (
    <h3 className="font-semibold text-sm">{t("notifications.title")}</h3>
  );
}
```

### Pattern 2: Role Label Translation
**What:** Replace hardcoded role label maps with translations
**When:** formatRole() helper functions exist

```typescript
// Before - hardcoded in each component
function formatRole(role?: string | null) {
  const labels: Record<string, string> = {
    investor: "Investor",
    broker: "Broker",
    // ...
  };
  return labels[role] || role;
}

// After - use common.roles namespace
const t = useTranslations("common.roles");
function getRoleLabel(role: string) {
  const keyMap: Record<string, string> = {
    investor: "investor",
    broker: "broker",
    mortgage_advisor: "mortgageAdvisor",
    // ...
  };
  return t(keyMap[role] || role);
}
```

### Anti-Patterns to Avoid
- **Don't translate console.error messages** - these are for developers
- **Don't translate technical placeholders** (e.g., "0", numeric defaults)
- **Don't translate email/URL examples** - keep as-is
- **Don't create new namespaces** - use existing ones

## Components Needing Translation

### HIGH PRIORITY (User-facing, frequently seen)

| Component | File | Hardcoded Strings | Add to Namespace |
|-----------|------|-------------------|------------------|
| NotificationCenter | `notifications/NotificationCenter.tsx` | "Notifications", "Mark all read", "Loading...", "No notifications", "You're all caught up!" | `common.notifications` (new sub-namespace) |
| ConversationSelector | `chat/ConversationSelector.tsx` | "New Chat", "New Group", "Search conversations...", "No conversations yet/match", "No messages yet", role labels | `chat` |
| NewConversationDialog | `chat/NewConversationDialog.tsx` | "New Conversation", "New Group", "Creating...", "Start Chat", "Create Group", role labels | `chat` |
| AddMembersDialog | `chat/AddMembersDialog.tsx` | "Add Members", "Select users to add", "Search users...", "Adding...", role labels | `chat` |
| MortgageCalculator | `properties/MortgageCalculator.tsx` | "Mortgage Calculator", "Property Price", "Down Payment", "Interest Rate", "Loan Term", "15/20/25/30 years", "Monthly Payment", "Loan Amount", "Total Interest", "Total Payment" | `properties.mortgage` (new sub-namespace) |

### MEDIUM PRIORITY (Secondary screens)

| Component | File | Hardcoded Strings | Add to Namespace |
|-----------|------|-------------------|------------------|
| PropertySelector | `feed/PropertySelector.tsx` | "You haven't listed...", "Add a property listing...", "Search properties...", "No properties match", "Untitled Property", "Unknown", status labels | `feed.propertySelector` or `properties` |
| GroupSettingsDialog | `chat/GroupSettingsDialog.tsx` | Form labels | `chat.group` |
| DealSelector | `chat/DealSelector.tsx` | "Search deals...", "Unknown" fallbacks | `chat` |
| RepostDialog | `feed/RepostDialog.tsx` | "Repost", "Add your thoughts...", "Share" | `feed.share` |
| DirectChatThread | `chat/DirectChatThread.tsx` | "Unknown" fallback | `chat` |

### LOW PRIORITY (Edge cases, admin)

| Component | File | Hardcoded Strings | Add to Namespace |
|-----------|------|-------------------|------------------|
| PropertyForm | `properties/PropertyForm.tsx` | Placeholders like "e.g., Modern Apartment in Tel Aviv", "Select a city", numeric placeholders | `properties.form` |
| ProviderProfileForm | `profile/ProviderProfileForm.tsx` | Various placeholders | `settings.profile` or `profile` |
| InvestorProfileForm | `profile/InvestorProfileForm.tsx` | Various placeholders | `settings.profile` or `profile` |
| ParticipantSelectorDialog | `chat/ParticipantSelectorDialog.tsx` | "No participants available" | `chat` |
| design-system page | `app/[locale]/(app)/design-system/page.tsx` | All showcase labels | Skip (dev tool) |

## Don't Hand-Roll

| Problem | Don't Build | Use Instead | Why |
|---------|-------------|-------------|-----|
| Role labels | Hardcoded label maps in each component | `common.roles` namespace | Already exists with all roles translated |
| Property type labels | Inline label arrays | `common.propertyTypes` namespace | Already exists |
| Status labels | Inline status text | `common.status` or `properties.status` | Already exists |
| Action buttons | Hardcoded "Cancel", "Save" | `common.actions` namespace | Already has all common actions |

## Common Pitfalls

### Pitfall 1: Forgetting Hebrew translation
**What goes wrong:** Adding English key but not Hebrew equivalent
**Why it happens:** Easy to only edit en.json
**How to avoid:** Always edit both files in same commit
**Warning signs:** Grep for keys that exist in en.json but not he.json

### Pitfall 2: Using wrong namespace
**What goes wrong:** Duplicating keys across namespaces
**Why it happens:** Not checking existing structure
**How to avoid:** Search en.json first for similar keys
**Warning signs:** Same English text appearing multiple times

### Pitfall 3: Translating placeholders that should stay
**What goes wrong:** Translating numeric examples like "100,000"
**Why it happens:** Over-zealous translation
**How to avoid:** Leave numeric examples as-is, only translate labels
**Warning signs:** Placeholders looking odd in Hebrew

## Code Examples

### Adding notifications namespace

```json
// messages/en.json - add to "common" section
{
  "common": {
    "notifications": {
      "title": "Notifications",
      "markAllRead": "Mark all read",
      "loading": "Loading...",
      "empty": "No notifications",
      "caughtUp": "You're all caught up!"
    }
  }
}

// messages/he.json - corresponding Hebrew
{
  "common": {
    "notifications": {
      "title": "התראות",
      "markAllRead": "סמן הכל כנקרא",
      "loading": "טוען...",
      "empty": "אין התראות",
      "caughtUp": "הכל נקרא!"
    }
  }
}
```

### Adding mortgage calculator namespace

```json
// messages/en.json - add to "properties" section
{
  "properties": {
    "mortgage": {
      "title": "Mortgage Calculator",
      "propertyPrice": "Property Price",
      "downPayment": "Down Payment",
      "interestRate": "Interest Rate (%)",
      "loanTerm": "Loan Term",
      "years": "{count} years",
      "monthlyPayment": "Monthly Payment",
      "loanAmount": "Loan Amount",
      "totalInterest": "Total Interest",
      "totalPayment": "Total Payment"
    }
  }
}
```

### Translating component with role labels

```typescript
// chat/AddMembersDialog.tsx
import { useTranslations } from "next-intl";

export function AddMembersDialog(...) {
  const t = useTranslations("chat.group");
  const tRoles = useTranslations("common.roles");
  const tActions = useTranslations("common.actions");

  // Use existing role translations
  const getRoleLabel = (role: string) => {
    const keyMap: Record<string, string> = {
      investor: "investor",
      broker: "broker",
      mortgage_advisor: "mortgageAdvisor",
      lawyer: "lawyer",
      admin: "admin",
    };
    return tRoles(keyMap[role] || role);
  };

  return (
    <Dialog>
      <DialogTitle>{t("addMembers")}</DialogTitle>
      {/* ... */}
      <Button onClick={handleClose}>{tActions("cancel")}</Button>
    </Dialog>
  );
}
```

## State of the Art

| Old Approach | Current Approach | When Changed | Impact |
|--------------|------------------|--------------|--------|
| Hardcoded English | useTranslations hook | Phase 31 | All new components should use translations |
| Single namespace | Nested namespaces by feature | Phase 31 | Organized by feature area |

## Open Questions

1. **PropertyForm placeholders**: Should example placeholders like "e.g., Modern Apartment in Tel Aviv" be translated?
   - Recommendation: Yes, translate to Hebrew equivalent example
   - Risk: LOW - just helpful examples

2. **Design system page**: Should the design system showcase be translated?
   - Recommendation: No, skip - it's a developer tool
   - Risk: None - not user-facing

## Sources

### Primary (HIGH confidence)
- Phase 31 RESEARCH.md - established patterns
- Phase 34 VERIFICATION.md - confirmed translation infrastructure works
- messages/en.json - existing translation keys (1800+ lines)
- messages/he.json - existing Hebrew translations

### Secondary (MEDIUM confidence)
- Component source code scan - identified specific hardcoded strings
- Grep analysis - found ~27 components needing translation

## Metadata

**Confidence breakdown:**
- Component identification: HIGH - direct source code analysis
- Translation keys needed: HIGH - compared against existing JSON
- Namespace assignment: HIGH - follows established patterns

**Research date:** 2026-01-20
**Valid until:** Indefinite - translation patterns are stable

## Estimated Scope

| Category | Files | Estimated Keys | Priority |
|----------|-------|----------------|----------|
| Notifications | 1 | ~5 | HIGH |
| Chat dialogs | 5 | ~30 | HIGH |
| Mortgage Calculator | 1 | ~12 | MEDIUM |
| Feed selectors | 2 | ~10 | MEDIUM |
| Form placeholders | 3 | ~20 | LOW |
| **Total** | **~12** | **~77** | - |

Note: GlobalSearchBar and InvestorSearchBar were recently translated (per git history), so they are NOT included in scope.
