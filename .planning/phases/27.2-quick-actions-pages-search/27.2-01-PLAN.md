---
phase: 27.2-quick-actions-pages-search
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/search-actions.ts
  - src/components/search/GlobalSearchBar.tsx
autonomous: true

must_haves:
  truths:
    - "User can search for 'Set' and see Settings page as result"
    - "User can search for pages by alias keywords (e.g., 'config' shows Settings)"
    - "Quick Actions appear FIRST before Users/Posts/Properties in search"
    - "Only pages the user can access are shown (role-aware)"
    - "Selecting a quick action navigates to that page"
  artifacts:
    - path: "src/lib/search-actions.ts"
      provides: "Quick action types, keyword mappings, filter functions"
      exports: ["QuickAction", "getQuickActionsForRole", "filterQuickActions"]
    - path: "src/components/search/GlobalSearchBar.tsx"
      provides: "Enhanced search with Quick Actions group"
      contains: "CommandGroup heading=\"Quick Actions\""
  key_links:
    - from: "src/components/search/GlobalSearchBar.tsx"
      to: "src/lib/search-actions.ts"
      via: "import getQuickActionsForRole, filterQuickActions"
      pattern: "getQuickActionsForRole\\(role\\)"
    - from: "src/lib/search-actions.ts"
      to: "src/lib/navigation.ts"
      via: "import getNavigationForRole"
      pattern: "getNavigationForRole\\(role\\)"
---

<objective>
Add quick actions and page navigation to global search so users can search for app pages.

Purpose: When user searches "Set", show Settings page as first result before other content.
Output: Quick Actions helper and enhanced GlobalSearchBar with page navigation.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/lib/navigation.ts - Navigation config with getNavigationForRole()
@src/components/search/GlobalSearchBar.tsx - Search component to enhance
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create search-actions helper</name>
  <files>src/lib/search-actions.ts</files>
  <action>
Create search-actions.ts helper that:
1. Defines QuickAction type with label, href, icon, keywords, category
2. Creates KEYWORD_MAPPINGS object with aliases for common pages:
   - Settings: ["preferences", "config", "account", "options"]
   - Profile: ["me", "account", "my profile", "user"]
   - Dashboard: ["home", "overview", "main"]
   - etc. for all navigation items
3. Implements flattenNavItem() to recursively convert NavItem to QuickAction[]
4. Implements getQuickActionsForRole(role) using getNavigationForRole() from navigation.ts
5. Implements getMatchScore() with scoring:
   - Exact match: 100
   - Starts with: 80
   - Word boundary: 70
   - Contains: 60
   - Keyword exact: 50
   - Keyword starts with: 40
   - Keyword contains: 30
6. Implements filterQuickActions(actions, query) returning sorted matches

Export: QuickAction, getQuickActionsForRole, filterQuickActions
  </action>
  <verify>TypeScript compiles without errors: npm run build</verify>
  <done>Helper exports getQuickActionsForRole() and filterQuickActions() functions</done>
</task>

<task type="auto">
  <name>Task 2: Integrate Quick Actions into GlobalSearchBar</name>
  <files>src/components/search/GlobalSearchBar.tsx</files>
  <action>
Update GlobalSearchBar.tsx to:
1. Import getQuickActionsForRole, filterQuickActions from @/lib/search-actions
2. Add useMemo for quickActions using currentUser?.role (default to "investor")
3. Add useMemo for filteredQuickActions using filterQuickActions(quickActions, inputValue)
4. Add hasQuickActions boolean check
5. Add Quick Actions CommandGroup BEFORE Users/Posts/Properties:
   - Show when hasQuery (even if no backend results)
   - Limit to 5 results with .slice(0, 5)
   - Each item: action.icon + label + Badge "Page"
   - value format: "action:{href}"
6. Update handleSelect to handle "action:" type - navigate to href
7. Add CommandSeparator between Quick Actions and other groups
  </action>
  <verify>
1. npm run build passes
2. Search "Set" shows Settings as Quick Action
3. Search "config" shows Settings (keyword match)
4. Quick Actions appear before Users/Posts/Properties
  </verify>
  <done>GlobalSearchBar shows Quick Actions group first with role-aware page navigation</done>
</task>

</tasks>

<verification>
1. Build passes: npm run build
2. Search "Set" -> Settings page shown in Quick Actions
3. Search "config" -> Settings page shown (keyword alias)
4. Search "prop" -> Browse Properties shown
5. Quick Actions group appears BEFORE Users/Posts/Properties
6. Selecting a Quick Action navigates to that page
7. Different roles see different Quick Actions (role-aware)
</verification>

<success_criteria>
- User can find Settings by typing "Set" or "config"
- Quick Actions always appear first in search results
- Only accessible pages for user's role are shown
- All keyword aliases work correctly
</success_criteria>

<output>
After completion, create `.planning/phases/27.2-quick-actions-pages-search/27.2-01-SUMMARY.md`
</output>
