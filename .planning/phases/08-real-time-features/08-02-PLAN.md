---
phase: 08-real-time-features
plan: 02
type: execute
---

<objective>
Build notification center UI with bell icon in header and toast notifications for real-time alerts.

Purpose: Give users immediate visibility into new events through a notification bell dropdown and non-intrusive toast popups.
Output: NotificationCenter component in AppHeader, toast integration for real-time alerts.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior work:
@.planning/phases/08-real-time-features/08-01-SUMMARY.md

# Key files:
@convex/notifications.ts
@src/components/layout/AppHeader.tsx
@src/components/ui/popover.tsx
@src/components/ui/toast.tsx

**Tech stack available:** Convex, Shadcn/ui (Popover, Badge, ScrollArea, Toast/Sonner), Hugeicons
**Established patterns:**
- Popover for dropdown menus
- useQuery for reactive data
- Relative timestamps (from ProviderDashboard)
- Icon buttons in header

**Constraining decisions:**
- Phase 5.2: effectiveRole pattern for role-aware UI
- Phase 7: Activity feed with relative timestamps pattern
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create NotificationCenter component</name>
  <files>src/components/notifications/NotificationCenter.tsx</files>
  <action>
Create NotificationCenter component with:

**Structure:**
- Bell icon button (Notification01Icon from Hugeicons)
- Badge with unread count (hidden when 0)
- Popover dropdown on click

**Popover content:**
- Header: "Notifications" title + "Mark all read" button
- ScrollArea with max-h-80 for notification list
- Empty state when no notifications

**NotificationItem component (inline or separate):**
- Icon based on notification type (message, deal, file, request)
- Title + message preview
- Relative timestamp
- Unread indicator (dot or background)
- Click navigates to link and marks as read

**Data:**
- useQuery for notifications.list
- useQuery for notifications.getUnreadCount
- useMutation for markAsRead, markAllAsRead

Use Shadcn Popover, Button, Badge, ScrollArea components.
  </action>
  <verify>Component renders without errors, TypeScript compiles</verify>
  <done>NotificationCenter shows bell with count badge, popover with notification list</done>
</task>

<task type="auto">
  <name>Task 2: Integrate NotificationCenter into AppHeader</name>
  <files>src/components/layout/AppHeader.tsx</files>
  <action>
Add NotificationCenter to AppHeader:

- Import NotificationCenter from notifications folder
- Add to header actions area (before user menu if exists)
- Ensure proper spacing with existing header elements
- Only show when user is authenticated

Position bell icon to the right of navigation but before any user avatar/menu.
  </action>
  <verify>npm run build passes, notification bell appears in header</verify>
  <done>NotificationCenter visible in AppHeader for authenticated users</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Notification center with bell icon, unread badge, and popover dropdown in the app header</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Sign in to the app
    3. Navigate to any authenticated page
    4. Verify: Bell icon visible in header
    5. Click bell: Popover opens with notification list (may be empty)
    6. If notifications exist: Click one to navigate and mark as read
    7. Test "Mark all read" button
    8. Verify: Badge count updates correctly
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] NotificationCenter renders in header
- [ ] Popover opens/closes correctly
- [ ] Notifications display with proper formatting
- [ ] Click notification navigates and marks read
- [ ] Badge updates reactively
</verification>

<success_criteria>
- NotificationCenter component integrated into AppHeader
- Bell icon with unread count badge
- Popover dropdown with notification list
- Mark as read functionality working
- Phase 8: Real-time Features complete
</success_criteria>

<output>
After completion, create `.planning/phases/08-real-time-features/08-02-SUMMARY.md`

Update STATE.md:
- Phase: 8 of 8 complete
- Status: Milestone complete
- Progress: 100%
</output>
