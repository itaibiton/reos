---
phase: 37-mobile-navigation
plan: 03
type: execute
wave: 2
depends_on: ["37-01"]
files_modified:
  - src/components/layout/AppShell.tsx
autonomous: true

must_haves:
  truths:
    - "MobileBottomNav renders inside AppShell on mobile"
    - "Main content has bottom padding on mobile to not overlap tab bar"
    - "Full-bleed pages account for tab bar height"
    - "Sidebar not visible on mobile (replaced by bottom tabs)"
  artifacts:
    - path: "src/components/layout/AppShell.tsx"
      provides: "AppShell with integrated MobileBottomNav"
      contains: "MobileBottomNav"
  key_links:
    - from: "src/components/layout/AppShell.tsx"
      to: "MobileBottomNav"
      via: "import and render"
      pattern: "import.*MobileBottomNav"
---

<objective>
Integrate MobileBottomNav into AppShell layout

Purpose: Wire MobileBottomNav into the app shell so it displays on mobile, with proper content padding to prevent overlap (NAV-08)
Output: AppShell.tsx renders MobileBottomNav and adjusts content area for mobile
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v1.5-ROADMAP.md
@.planning/phases/37-mobile-navigation/37-RESEARCH.md
@src/components/layout/AppShell.tsx
@src/components/layout/MobileBottomNav.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Import MobileBottomNav and useIsMobile</name>
  <files>src/components/layout/AppShell.tsx</files>
  <action>
Add imports at the top of AppShell.tsx (near other layout imports around line 20):

```typescript
import { MobileBottomNav } from "./MobileBottomNav";
import { useIsMobile } from "@/hooks/use-mobile";
```

The MobileBottomNav import goes with other layout component imports (AppSidebar, InvestorSearchBar).
The useIsMobile hook is used for conditional padding.
  </action>
  <verify>
Check imports are valid:
```bash
grep -q "MobileBottomNav" src/components/layout/AppShell.tsx && echo "OK: MobileBottomNav imported"
grep -q "useIsMobile" src/components/layout/AppShell.tsx && echo "OK: useIsMobile imported"
```
  </verify>
  <done>
MobileBottomNav and useIsMobile imported in AppShell.tsx
  </done>
</task>

<task type="auto">
  <name>Task 2: Add isMobile detection and render MobileBottomNav</name>
  <files>src/components/layout/AppShell.tsx</files>
  <action>
1. Inside AppShell component, after existing hooks (around line 287-290), add:
```typescript
const isMobile = useIsMobile();
```

2. Update the main content area to add bottom padding on mobile.
Find the `<main>` tag (around line 370) and update:

BEFORE:
```tsx
<main className={isFullBleedPage ? "" : "p-6"}>
```

AFTER:
```tsx
<main className={cn(
  isFullBleedPage ? "" : "p-6",
  isMobile && "pb-20" // Space for bottom tab bar (~80px)
)}>
```

3. Update the full-bleed page height calculation.
Find the div with `h-[calc(100dvh-4rem)]` (around line 372) and update:

BEFORE:
```tsx
<div className="h-[calc(100dvh-4rem)]">{children}</div>
```

AFTER:
```tsx
<div className={cn(
  "h-[calc(100dvh-4rem)]",
  isMobile && "h-[calc(100dvh-4rem-5rem)]" // Subtract tab bar height
)}>
  {children}
</div>
```

4. Render MobileBottomNav at the end of the component.
Find the closing `</SidebarProvider>` tag (around line 378) and add MobileBottomNav just before it:

BEFORE:
```tsx
      </SidebarInset>
    </SidebarProvider>
```

AFTER:
```tsx
      </SidebarInset>
      <MobileBottomNav />
    </SidebarProvider>
```

Note: MobileBottomNav handles its own md:hidden, so it only shows on mobile. The sidebar already handles its mobile behavior via Shadcn's responsive sidebar.
  </action>
  <verify>
1. TypeScript compiles:
```bash
npx tsc --noEmit src/components/layout/AppShell.tsx
```

2. Verify changes:
```bash
grep -q "isMobile && \"pb-20\"" src/components/layout/AppShell.tsx && echo "OK: Mobile padding added"
grep -q "<MobileBottomNav" src/components/layout/AppShell.tsx && echo "OK: MobileBottomNav rendered"
grep -q "isMobile && \"h-\\[calc" src/components/layout/AppShell.tsx && echo "OK: Full-bleed height adjusted"
```
  </verify>
  <done>
- isMobile hook used for conditional styling
- Main content has pb-20 on mobile (space for tab bar)
- Full-bleed pages subtract tab bar height on mobile
- MobileBottomNav rendered inside SidebarProvider
- Sidebar automatically hidden on mobile (Shadcn behavior)
  </done>
</task>

</tasks>

<verification>
- [ ] MobileBottomNav imported from "./MobileBottomNav"
- [ ] useIsMobile imported from "@/hooks/use-mobile"
- [ ] isMobile variable declared in component
- [ ] Main content has conditional pb-20 on mobile
- [ ] Full-bleed page height accounts for tab bar on mobile
- [ ] MobileBottomNav rendered inside SidebarProvider
- [ ] TypeScript compiles without errors
- [ ] App builds successfully: `npm run build`
</verification>

<success_criteria>
1. Mobile users see bottom tab bar (MobileBottomNav renders)
2. Content doesn't overlap tab bar (pb-20 padding applied)
3. Full-bleed pages (properties, chat) don't have content cut off
4. Desktop users see sidebar only (no bottom tabs)
5. No TypeScript or build errors
</success_criteria>

<output>
After completion, create `.planning/phases/37-mobile-navigation/37-03-SUMMARY.md`
</output>
