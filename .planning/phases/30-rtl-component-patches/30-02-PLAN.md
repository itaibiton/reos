---
phase: 30-rtl-component-patches
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/sheet.tsx
  - src/components/ui/navigation-menu.tsx
  - src/components/ui/dropdown-menu.tsx
  - src/components/ui/context-menu.tsx
  - src/components/ui/menubar.tsx
  - src/components/ui/breadcrumb.tsx
  - src/components/ui/pagination.tsx
  - src/components/ui/carousel.tsx
autonomous: true

must_haves:
  truths:
    - "User in Hebrew mode sees Sheet slide from correct edge (right sheet slides from right, left sheet slides from left)"
    - "User in Hebrew mode sees dropdown/context/menubar sub-menu chevrons pointing left"
    - "User in Hebrew mode sees pagination arrows pointing correct directions"
    - "User in Hebrew mode sees breadcrumb separators pointing left"
    - "User in Hebrew mode sees carousel navigating in correct direction"
  artifacts:
    - path: "src/components/ui/sheet.tsx"
      provides: "RTL-aware slide animations"
      contains: "slide-in-from-end"
    - path: "src/components/ui/dropdown-menu.tsx"
      provides: "RTL-flipping chevron in sub-trigger"
      contains: "rtl:-scale-x-100"
    - path: "src/components/ui/carousel.tsx"
      provides: "RTL-aware carousel with direction option"
      contains: "useDirection"
  key_links:
    - from: "src/components/ui/sheet.tsx"
      to: "tw-animate-css"
      via: "logical animation classes"
      pattern: "slide-(in|out)-(from|to)-(start|end)"
    - from: "src/components/ui/carousel.tsx"
      to: "embla-carousel-react"
      via: "direction option"
      pattern: "direction:"
---

<objective>
Patch Shadcn UI components with directional elements (chevrons, arrows, animations) to flip appropriately in RTL mode.

Purpose: Directional UI elements must flip in RTL to maintain semantic meaning - a "forward" chevron should always point toward reading direction.

Output: 8 Shadcn components updated with RTL-aware directional icons and animations.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v1.4-ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-rtl-component-patches/30-RESEARCH.md
@src/components/ui/sheet.tsx
@src/components/ui/navigation-menu.tsx
@src/components/ui/dropdown-menu.tsx
@src/components/ui/context-menu.tsx
@src/components/ui/menubar.tsx
@src/components/ui/breadcrumb.tsx
@src/components/ui/pagination.tsx
@src/components/ui/carousel.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update Sheet animations to use logical directions</name>
  <files>src/components/ui/sheet.tsx</files>
  <action>
Update src/components/ui/sheet.tsx SheetContent to use logical animation classes from tw-animate-css:

In the className for SheetPrimitive.Content, replace physical animation directions with logical ones:

Current (line ~62-65):
```typescript
side === "right" &&
  "data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 end-0 h-full w-3/4 border-s sm:max-w-sm",
side === "left" &&
  "data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 start-0 h-full w-3/4 border-e sm:max-w-sm",
```

Change to:
```typescript
side === "right" &&
  "data-[state=closed]:slide-out-to-end data-[state=open]:slide-in-from-end inset-y-0 end-0 h-full w-3/4 border-s sm:max-w-sm",
side === "left" &&
  "data-[state=closed]:slide-out-to-start data-[state=open]:slide-in-from-start inset-y-0 start-0 h-full w-3/4 border-e sm:max-w-sm",
```

Note: `slide-in-from-end` slides from the inline-end direction (right in LTR, left in RTL), matching the logical positioning from `end-0`. Similarly `slide-in-from-start` matches `start-0`.
  </action>
  <verify>Run `grep -E "slide-(in|out)-(from|to)-(start|end)" src/components/ui/sheet.tsx` - should show 4 matches</verify>
  <done>Sheet animations use logical directions that auto-flip for RTL</done>
</task>

<task type="auto">
  <name>Task 2: Update Navigation Menu animations</name>
  <files>src/components/ui/navigation-menu.tsx</files>
  <action>
Update src/components/ui/navigation-menu.tsx NavigationMenuContent animations:

The tw-animate-css library does NOT have `slide-in-from-start-52` or `slide-in-from-end-52` variants with numeric suffixes. Instead, use the rtl: modifier approach.

In NavigationMenuContent (line ~93), the current animation classes are:
```
data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52
```

Change to use rtl: modifiers:
```
data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-end]:rtl:slide-in-from-left-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=from-start]:rtl:slide-in-from-right-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-end]:rtl:slide-out-to-left-52 data-[motion=to-start]:slide-out-to-left-52 data-[motion=to-start]:rtl:slide-out-to-right-52
```

This swaps the animation directions in RTL mode.
  </action>
  <verify>Run `grep "rtl:slide" src/components/ui/navigation-menu.tsx` - should show rtl modifiers</verify>
  <done>Navigation menu content slides from correct direction in RTL mode</done>
</task>

<task type="auto">
  <name>Task 3: Add RTL flip to menu component chevrons</name>
  <files>src/components/ui/dropdown-menu.tsx, src/components/ui/context-menu.tsx, src/components/ui/menubar.tsx, src/components/ui/breadcrumb.tsx</files>
  <action>
Add `rtl:-scale-x-100` to ChevronRight icons in sub-triggers and separators:

1. **dropdown-menu.tsx** - DropdownMenuSubTrigger (line ~220):
   Current: `<ChevronRightIcon className="ms-auto size-4" />`
   Change to: `<ChevronRightIcon className="ms-auto size-4 rtl:-scale-x-100" />`

2. **context-menu.tsx** - ContextMenuSubTrigger (line ~75):
   Current: `<ChevronRightIcon className="ms-auto" />`
   Change to: `<ChevronRightIcon className="ms-auto rtl:-scale-x-100" />`

3. **menubar.tsx** - MenubarSubTrigger (line ~238):
   Current: `<ChevronRightIcon className="ms-auto h-4 w-4" />`
   Change to: `<ChevronRightIcon className="ms-auto h-4 w-4 rtl:-scale-x-100" />`

4. **breadcrumb.tsx** - BreadcrumbSeparator (line ~78):
   Current: `{children ?? <ChevronRight />}`
   Change to: `{children ?? <ChevronRight className="rtl:-scale-x-100" />}`

The `rtl:-scale-x-100` class flips the icon horizontally when in RTL mode, making ChevronRight point left (which is the "forward" direction in RTL).
  </action>
  <verify>Run `grep -l "rtl:-scale-x-100" src/components/ui/dropdown-menu.tsx src/components/ui/context-menu.tsx src/components/ui/menubar.tsx src/components/ui/breadcrumb.tsx` - should list all 4 files</verify>
  <done>All menu sub-trigger and breadcrumb chevrons flip correctly in RTL mode</done>
</task>

<task type="auto">
  <name>Task 4: Add RTL flip to pagination arrows</name>
  <files>src/components/ui/pagination.tsx</files>
  <action>
Update src/components/ui/pagination.tsx to flip pagination chevrons in RTL:

1. **PaginationPrevious** (line ~79):
   Current: `<ChevronLeftIcon />`
   Change to: `<ChevronLeftIcon className="rtl:-scale-x-100" />`

2. **PaginationNext** (line ~97):
   Current: `<ChevronRightIcon />`
   Change to: `<ChevronRightIcon className="rtl:-scale-x-100" />`

In RTL, "previous" (going backward in page order) should have its arrow pointing right (the backward direction in RTL), and "next" should point left. The flip makes this happen automatically.
  </action>
  <verify>Run `grep "rtl:-scale-x-100" src/components/ui/pagination.tsx | wc -l` - should return 2</verify>
  <done>Pagination arrows point in correct direction for RTL reading order</done>
</task>

<task type="auto">
  <name>Task 5: Add RTL support to Carousel</name>
  <files>src/components/ui/carousel.tsx</files>
  <action>
Update src/components/ui/carousel.tsx for RTL support:

1. Add import at top:
   ```typescript
   import { useDirection } from "@radix-ui/react-direction";
   ```

2. Inside the `Carousel` function, after destructuring props, add:
   ```typescript
   const direction = useDirection();
   ```

3. Update the useEmblaCarousel call to include direction (line ~54-60):
   ```typescript
   const [carouselRef, api] = useEmblaCarousel(
     {
       ...opts,
       axis: orientation === "horizontal" ? "x" : "y",
       direction: direction === "rtl" ? "rtl" : "ltr",
     },
     plugins
   )
   ```

4. **CarouselPrevious** (line ~198):
   Current: `<ArrowLeft />`
   Change to: `<ArrowLeft className="rtl:-scale-x-100" />`

5. **CarouselNext** (line ~228):
   Current: `<ArrowRight />`
   Change to: `<ArrowRight className="rtl:-scale-x-100" />`

The direction option tells Embla to reverse slide order in RTL, and the icon flips ensure visual consistency.
  </action>
  <verify>Run `grep -E "(useDirection|direction:|rtl:-scale-x-100)" src/components/ui/carousel.tsx | wc -l` - should return 4 (1 import, 1 direction option, 2 icon flips)</verify>
  <done>Carousel slides in correct direction and has flipped navigation arrows in RTL mode</done>
</task>

</tasks>

<verification>
1. Start the dev server: `npm run dev`
2. Navigate to `/he/` pages in Hebrew mode and test:

**Sheet:**
- Open a Sheet component (e.g., mobile sidebar)
- Verify it slides from correct edge (side="right" slides from right in RTL)

**Navigation Menu:**
- If navigation menu exists in app, verify dropdown content slides from correct direction

**Dropdown/Context/Menu chevrons:**
- Open a dropdown menu with sub-menus
- Verify ChevronRight icons point LEFT in RTL mode

**Breadcrumb:**
- View a page with breadcrumbs
- Verify separator chevrons point LEFT in RTL mode

**Pagination:**
- View paginated content
- Verify Previous arrow points RIGHT, Next arrow points LEFT in RTL

**Carousel:**
- View image carousel (e.g., property detail page)
- Verify navigation feels natural (prev goes to previous, next goes to next)
- Verify arrow icons flip correctly
</verification>

<success_criteria>
- All directional icons flip appropriately in RTL mode
- Animation directions match positioning (end-0 with slide-from-end)
- Carousel navigation feels natural in both directions
- No visual glitches or jarring animation mismatches
</success_criteria>

<output>
After completion, create `.planning/phases/30-rtl-component-patches/30-02-SUMMARY.md`
</output>
