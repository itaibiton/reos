---
phase: 05.2-mock-data-super-user
plan: 01
type: execute
---

<objective>
Add mock property data and super user role-switching for testing.

Purpose: Enable quick testing of all user roles and populate marketplace with realistic Israeli properties.
Output: Seed data for 10-15 properties, role-switching dropdown in header.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context:
@.planning/phases/05.1-add-also-regular-filter/05.1-01-SUMMARY.md

# Key source files:
@convex/schema.ts
@convex/properties.ts
@convex/users.ts
@src/components/layout/Header.tsx
@src/lib/constants.ts

**Tech stack available:** Next.js, Convex, Shadcn/ui, Clerk
**Established patterns:**
- Convex mutations for data operations
- Shadcn DropdownMenu for selection UI
- UserButton placement in Header

**Constraining decisions:**
- Phase 4: USD/ILS rate as constant (3.7) for MVP
- Phase 4: Any authenticated user can create properties
- Phase 2: User roles: investor, broker, mortgage_advisor, lawyer
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create mock property data and seed function</name>
  <files>convex/seedData.ts, convex/seed.ts</files>
  <action>
Create two files:

1. `convex/seedData.ts` - Mock property data array with 12-15 diverse Israeli properties:
   - Cover all ISRAELI_LOCATIONS (at least Tel Aviv, Jerusalem, Haifa, Herzliya, Netanya)
   - Mix of property types (residential, commercial, mixed_use)
   - Price range: $150k to $2M USD (with ILS at 3.7 rate)
   - Include all optional metrics (ROI, cap rate, cash-on-cash, monthly rent)
   - Bedrooms: 1-5, Bathrooms: 1-3, Square meters: 40-300
   - Year built: 1990-2024
   - Use realistic Israeli addresses (street names like "Rothschild Blvd", "Dizengoff St", "King George St")
   - All status: "available"
   - Images: use placeholder URLs like "https://placehold.co/800x600?text=Property+1"

2. `convex/seed.ts` - Seed mutation:
   - Export `seedProperties` mutation (no auth required for seeding)
   - Insert all properties from seedData
   - Use a hardcoded system user ID or skip createdBy validation for seed data
   - Return count of inserted properties
   - Add `clearProperties` mutation to delete all properties (for reset)

Note: Seed mutation needs to work without auth since it's called from Convex dashboard or CLI.
  </action>
  <verify>
Run `npx convex dev` - no TypeScript errors. Check convex/seed.ts exports seedProperties and clearProperties.
  </verify>
  <done>
Two files created. Seed mutations exported. Data includes 12+ properties across Israeli cities with varied types and price ranges.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add role-switching dropdown to Header</name>
  <files>src/components/layout/Header.tsx, convex/users.ts</files>
  <action>
Modify Header.tsx to add a role-switching dropdown for testing:

1. Add imports: DropdownMenu, DropdownMenuTrigger, DropdownMenuContent, DropdownMenuItem, DropdownMenuLabel from Shadcn
2. Import useMutation, useQuery from "convex/react" and api
3. Inside Authenticated block, before UserButton:
   - Query current user with `useQuery(api.users.getCurrentUser)`
   - Add DropdownMenu with trigger showing current role (or "Select Role")
   - List all 4 roles: Investor, Broker, Mortgage Advisor, Lawyer
   - On click, call `useMutation(api.users.setUserRole)` with selected role
   - Show checkmark or highlight on current role
   - Use small text/badge style to not dominate header

4. Style: Compact dropdown trigger (text-xs or Badge), fits between logo area and UserButton

5. Note: For MVP, show to all users (testing mode). Later can restrict to specific users.

Do NOT add env-based hiding - keep it visible for all users during development.
  </action>
  <verify>
Run `npm run dev`. Log in, see role dropdown in header. Click a role, confirm it updates. Refresh page, role persists.
  </verify>
  <done>
Header shows role dropdown for authenticated users. Clicking role updates user record. Current role indicated visually.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Mock data seed function and role-switching UI</what-built>
  <how-to-verify>
    1. Run: `npm run dev` and `npx convex dev`
    2. Open Convex dashboard: Run `seedProperties` mutation
    3. Visit: http://localhost:3000/properties
    4. Confirm: 12+ properties displayed with various cities, prices, types
    5. Check header: Role dropdown visible next to profile
    6. Test: Switch between roles (Investor, Broker, etc.)
    7. Verify: Role switch persists after page refresh
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npx convex dev` shows no TypeScript errors
- [ ] Seed mutation populates 12+ properties in Convex dashboard
- [ ] Properties visible on marketplace page with filters working
- [ ] Role dropdown in header switches user role
- [ ] Role persists after refresh
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Mock data provides realistic testing scenarios
- Role switching enables testing all user perspectives
</success_criteria>

<output>
After completion, create `.planning/phases/05.2-mock-data-super-user/05.2-01-SUMMARY.md`
</output>
