---
phase: 45-mobile-experience
plan: 03
type: execute
wave: 2
depends_on: [45-01, 45-02]
files_modified:
  - src/app/[locale]/(app)/profile/investor/summary/page.tsx
  - messages/en.json
  - messages/he.json
autonomous: false
user_setup: []

must_haves:
  truths:
    - "Mobile shows tabbed interface switching between Profile and AI Assistant views"
    - "Tab switching animates smoothly (no jarring transitions)"
    - "Chat input stays visible above keyboard when keyboard opens"
    - "All interactive elements have minimum 44px touch targets"
    - "Quick reply buttons are easily tappable without accidental adjacent presses"
  artifacts:
    - path: "src/app/[locale]/(app)/profile/investor/summary/page.tsx"
      provides: "Conditional mobile/desktop layout rendering"
      contains: "useIsMobile"
  key_links:
    - from: "page.tsx"
      to: "MobileInvestorSummary"
      via: "conditional mobile rendering"
      pattern: "isMobile.*MobileInvestorSummary"
    - from: "page.tsx"
      to: "desktop layout"
      via: "conditional desktop rendering"
      pattern: "!isMobile.*grid-cols-2"
---

<objective>
Wire up mobile detection in the investor summary page and verify the complete mobile experience.

Purpose: Complete the mobile experience by conditionally rendering the mobile tabbed layout on mobile devices and the existing side-by-side layout on desktop.

Output: Fully functional mobile investor summary with tabbed navigation, animated transitions, and touch-optimized interactions.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/45-mobile-experience/45-CONTEXT.md
@.planning/phases/45-mobile-experience/45-RESEARCH.md
@.planning/phases/45-mobile-experience/45-01-SUMMARY.md
@.planning/phases/45-mobile-experience/45-02-SUMMARY.md
@src/app/[locale]/(app)/profile/investor/summary/page.tsx
@src/components/profile/MobileInvestorSummary.tsx
@src/hooks/use-mobile.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update investor summary page with mobile detection</name>
  <files>src/app/[locale]/(app)/profile/investor/summary/page.tsx</files>
  <action>
Add mobile detection and conditional rendering to the investor summary page.

Changes:
1. Import useIsMobile hook
2. Import MobileInvestorSummary component
3. Conditionally render mobile vs desktop layout
4. Handle loading state appropriately for both

Add imports:
```tsx
import { useIsMobile } from "@/hooks/use-mobile";
import { MobileInvestorSummary } from "@/components/profile";
```

After questionnaire check, add mobile detection:
```tsx
const isMobile = useIsMobile();
```

Loading state - show appropriate skeleton for mobile vs desktop:
```tsx
if (questionnaire === undefined) {
  // Simple loading skeleton (works for both mobile and desktop)
  return (
    <div className="h-[calc(100vh-64px)] flex items-center justify-center">
      <Skeleton className="h-8 w-8 rounded-full" />
    </div>
  );
}
```

Main render - conditional layout:
```tsx
// Mobile: Tabbed interface
if (isMobile) {
  return <MobileInvestorSummary profileComplete={isComplete} />;
}

// Desktop: Side-by-side layout (existing)
return (
  <div className="h-[calc(100vh-64px)] grid grid-cols-1 lg:grid-cols-2 gap-0 p-0">
    {/* Left panel: Profile Summary */}
    <div className="border-e overflow-y-auto bg-background">
      <ProfileSummaryPanel />
    </div>

    {/* Right panel: AI Assistant */}
    <div className="flex flex-col h-full overflow-hidden">
      <AIChatPanel
        className="flex-1"
        renderQuickReplies={(sendMessage) => (
          <QuickReplyButtons
            onPromptSelect={sendMessage}
            profileComplete={isComplete}
          />
        )}
      />
    </div>
  </div>
);
```

The desktop layout stays exactly as is. We're just adding the mobile conditional branch.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>Investor summary page conditionally renders mobile tabbed layout</done>
</task>

<task type="auto">
  <name>Task 2: Add mobile tab translations</name>
  <files>messages/en.json, messages/he.json</files>
  <action>
Add translations for mobile tab labels.

Add to messages/en.json under a new "mobileTabs" namespace:
```json
"mobileTabs": {
  "profile": "Profile",
  "assistant": "AI Assistant"
}
```

Add to messages/he.json:
```json
"mobileTabs": {
  "profile": "פרופיל",
  "assistant": "עוזר AI"
}
```

Note: These translations will be used by MobileInvestorSummary component for tab labels.
If the component was created with hardcoded strings, update it to use useTranslations("mobileTabs").
  </action>
  <verify>JSON files are valid: `cat messages/en.json | jq . > /dev/null && cat messages/he.json | jq . > /dev/null`</verify>
  <done>Mobile tab labels have English and Hebrew translations</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Verify mobile experience</name>
  <what-built>
Complete mobile investor summary experience with:
- Tabbed interface (Profile / AI Assistant)
- Animated tab transitions (slide left/right)
- 44px touch targets on all interactive elements
- Horizontal scrolling quick reply buttons
- Drawer-based field editing
- Keyboard-aware chat input (on real mobile)
  </what-built>
  <how-to-verify>
1. Start dev server: `npm run dev`
2. Open http://localhost:3000/profile/investor/summary
3. Use browser DevTools to enable mobile view (iPhone 14 Pro or similar)
4. Verify:
   - [ ] Bottom tabs visible (Profile, AI Assistant)
   - [ ] Tapping tabs switches content with slide animation
   - [ ] Tab bar has proper safe area padding
   - [ ] Quick reply buttons scroll horizontally with visible gap
   - [ ] All buttons feel adequately sized for touch (44px)
   - [ ] Clicking a profile field opens drawer (not popover)
   - [ ] Drawer has Save/Cancel buttons at bottom
5. Test on actual mobile device if available:
   - [ ] Chat input stays visible when keyboard opens
   - [ ] No content hidden behind keyboard
   - [ ] Tab switching feels native and smooth
6. Switch to desktop view (>768px):
   - [ ] Shows side-by-side layout (not tabs)
   - [ ] Desktop experience unchanged from Phase 44
  </how-to-verify>
  <resume-signal>Type "approved" to complete phase, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
- [ ] `npx tsc --noEmit` passes
- [ ] Mobile shows tabbed interface
- [ ] Desktop shows side-by-side layout
- [ ] Tab transitions animate smoothly
- [ ] Touch targets are 44px minimum
- [ ] Quick replies have proper spacing
- [ ] Field editor uses drawer on mobile
- [ ] Translations work in both languages
</verification>

<success_criteria>
All Phase 45 requirements verified:
- MOB-01: Mobile layout uses tabbed interface (Profile / AI Assistant)
- MOB-02: Tab switching is smooth with appropriate animations
- MOB-03: Chat input is keyboard-aware (adjusts when keyboard opens)
- MOB-04: All touch targets are minimum 44px
- MOB-05: Quick reply buttons are easily tappable without accidental adjacent presses
</success_criteria>

<output>
After completion, create `.planning/phases/45-mobile-experience/45-03-SUMMARY.md`
</output>
