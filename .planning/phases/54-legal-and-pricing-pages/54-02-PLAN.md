---
phase: 54-legal-and-pricing-pages
plan: 02
type: execute
wave: 2
depends_on: ["54-01"]
files_modified:
  - src/app/[locale]/(main)/privacy/page.tsx
  - src/app/[locale]/(main)/terms/page.tsx
autonomous: true

must_haves:
  truths:
    - "User can navigate to /privacy and see a properly formatted privacy policy with table of contents and jump links"
    - "User can navigate to /terms and see a properly formatted terms of service with table of contents and jump links"
    - "Both pages show Last Updated date prominently"
    - "Both pages have correct Next.js metadata (title, description, Open Graph) in EN and HE"
    - "Both pages display in English and Hebrew with RTL support"
  artifacts:
    - path: "src/app/[locale]/(main)/privacy/page.tsx"
      provides: "Privacy Policy page with TOC, legal content, and i18n metadata"
      exports: ["default", "generateMetadata"]
    - path: "src/app/[locale]/(main)/terms/page.tsx"
      provides: "Terms of Service page with TOC, legal content, and i18n metadata"
      exports: ["default", "generateMetadata"]
  key_links:
    - from: "src/app/[locale]/(main)/privacy/page.tsx"
      to: "src/components/legal/TableOfContents.tsx"
      via: "import and render with headings array"
      pattern: "import.*TableOfContents.*from.*@/components/legal"
    - from: "src/app/[locale]/(main)/privacy/page.tsx"
      to: "messages/en.json legal.privacy namespace"
      via: "useTranslations('legal.privacy')"
      pattern: "useTranslations.*legal\\.privacy"
    - from: "src/app/[locale]/(main)/terms/page.tsx"
      to: "src/components/legal/TableOfContents.tsx"
      via: "import and render with headings array"
      pattern: "import.*TableOfContents.*from.*@/components/legal"
    - from: "src/app/[locale]/(main)/terms/page.tsx"
      to: "messages/en.json legal.terms namespace"
      via: "useTranslations('legal.terms')"
      pattern: "useTranslations.*legal\\.terms"
    - from: "src/app/[locale]/(main)/privacy/page.tsx"
      to: "generateMetadata"
      via: "getTranslations from next-intl/server for SEO metadata"
      pattern: "getTranslations.*legal\\.privacy\\.meta"
---

<objective>
Create Privacy Policy (/privacy) and Terms of Service (/terms) pages that render legal content with table of contents, jump links, last-updated date, responsive typography, and internationalized metadata.

Purpose: Users need accessible legal pages before the platform can collect personal data (LEGAL-BEFORE-CONTACT decision). These pages fulfill requirements LEGAL-01 through LEGAL-09.
Output: Two page routes under src/app/[locale]/(main)/ with proper generateMetadata and full legal content rendering.
</objective>

<execution_context>
@/home/ubuntu/.claude/get-shit-done/workflows/execute-plan.md
@/home/ubuntu/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/54-legal-and-pricing-pages/54-RESEARCH.md
@.planning/phases/54-legal-and-pricing-pages/54-01-SUMMARY.md
@src/app/[locale]/(main)/layout.tsx (shares Navigation + Footer layout)
@src/components/legal/index.ts (TableOfContents, LegalSection from Plan 01)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Privacy Policy page at /privacy</name>
  <files>src/app/[locale]/(main)/privacy/page.tsx</files>
  <action>
Create `src/app/[locale]/(main)/privacy/page.tsx` with:

**Page structure:**
- This is a mixed component: server-side generateMetadata + client-side page component
- Add `"use client"` at top (needed for TableOfContents which uses hooks)
- Import `TableOfContents` and `LegalSection` from `@/components/legal`
- Import `useTranslations` from `next-intl`
- Use namespace: `const t = useTranslations("legal.privacy")`

**Metadata (separate export in a layout or use a wrapper):**
Since "use client" prevents generateMetadata in the same file, create a separate approach:
- Option A: Create a thin server wrapper. Put generateMetadata in a separate file or at the layout level.
- RECOMMENDED: Make the page.tsx a SERVER component (no "use client"). Import TableOfContents as a client component. Use `useTranslations` from `next-intl` (works in server components in next-intl 4.x). If TableOfContents requires client-side hooks, that's fine -- it's already a client component imported into a server page.

**Correct approach: Server component page.tsx:**
```typescript
import type { Metadata } from "next";
import { getTranslations } from "next-intl/server";
import { useTranslations } from "next-intl";
import { TableOfContents, LegalSection } from "@/components/legal";

export async function generateMetadata({ params }: { params: Promise<{ locale: string }> }): Promise<Metadata> {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "legal.privacy.meta" });

  return {
    title: t("title"),
    description: t("description"),
    openGraph: {
      title: t("title"),
      description: t("description"),
      locale: locale === "he" ? "he_IL" : "en_US",
      type: "website",
    },
    alternates: {
      languages: {
        en: "/en/privacy",
        he: "/he/privacy",
      },
    },
  };
}
```

**Page component (server component using useTranslations):**
```typescript
export default function PrivacyPolicyPage() {
  const t = useTranslations("legal.privacy");

  // Define headings array for TOC -- must match section ids
  const headings = [
    { id: "introduction", text: t("sections.introduction.heading") },
    { id: "data-collection", text: t("sections.dataCollection.heading") },
    { id: "data-use", text: t("sections.dataUse.heading") },
    { id: "data-processors", text: t("sections.dataProcessors.heading") },
    { id: "cross-border", text: t("sections.crossBorder.heading") },
    { id: "data-sharing", text: t("sections.dataSharing.heading") },
    { id: "your-rights", text: t("sections.yourRights.heading") },
    { id: "data-security", text: t("sections.dataSecurity.heading") },
    { id: "cookies", text: t("sections.cookies.heading") },
    { id: "retention", text: t("sections.retention.heading") },
    { id: "children", text: t("sections.children.heading") },
    { id: "changes", text: t("sections.changes.heading") },
    { id: "contact", text: t("sections.contact.heading") },
  ];

  return (
    <div className="py-16 md:py-24">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        {/* Page title + last updated */}
        <div className="mb-12">
          <h1 className="text-4xl font-bold mb-3">{t("title")}</h1>
          <p className="text-muted-foreground">{t("lastUpdated")}</p>
        </div>

        {/* Two-column layout: TOC (sticky sidebar) + Content */}
        <div className="flex gap-12">
          {/* Sidebar TOC -- desktop only, sticky */}
          <aside className="hidden lg:block w-64 shrink-0">
            <TableOfContents headings={headings} />
          </aside>

          {/* Main content */}
          <article className="flex-1 max-w-[75ch] space-y-12">
            {/* Mobile TOC -- inline, non-sticky */}
            <div className="lg:hidden mb-8">
              <TableOfContents headings={headings} />
            </div>

            {/* Each section uses LegalSection wrapper */}
            <LegalSection id="introduction" heading={t("sections.introduction.heading")}>
              <p>{t("sections.introduction.content")}</p>
            </LegalSection>

            <LegalSection id="data-collection" heading={t("sections.dataCollection.heading")}>
              <h3 className="text-lg font-medium mt-4 mb-2">{t("sections.dataCollection.whatWeCollect.heading")}</h3>
              <p>{t("sections.dataCollection.whatWeCollect.content")}</p>
              <h3 className="text-lg font-medium mt-4 mb-2">{t("sections.dataCollection.automaticData.heading")}</h3>
              <p>{t("sections.dataCollection.automaticData.content")}</p>
            </LegalSection>

            {/* Continue for ALL sections: dataUse, dataProcessors (with processor list), crossBorder, dataSharing, yourRights (with ccpa, gdpr, israel subsections), dataSecurity, cookies, retention, children, changes, contact */}
          </article>
        </div>
      </div>
    </div>
  );
}
```

**Key details:**
- Responsive typography: `max-w-[75ch]` on article for optimal line length (45-75 chars per line)
- Use logical properties throughout (ps, pe, ms, me, border-s) for RTL support
- Single h1 for page title, h2 for sections (via LegalSection), h3 for subsections
- dataProcessors section: Render processor list (Clerk, Convex, Anthropic) with their descriptions
- yourRights section: Render three subsections (CCPA, GDPR, Israeli) with h3 headings
- The page inherits Navigation + Footer from (main)/layout.tsx -- no need to add them
- WCAG compliance: semantic HTML, proper heading hierarchy, aria-label on nav
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm TypeScript compiles. Run `npx next build` and check that /en/privacy and /he/privacy routes are generated without errors. Verify metadata: check the build output for the privacy page title.
  </verify>
  <done>
/privacy page route exists, renders full privacy policy content with 13 sections, table of contents with jump links, Last Updated date, responsive typography (75ch max-width), two-column desktop layout (sticky TOC sidebar), and proper generateMetadata with title/description/OpenGraph/alternates in both EN and HE.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Terms of Service page at /terms</name>
  <files>src/app/[locale]/(main)/terms/page.tsx</files>
  <action>
Create `src/app/[locale]/(main)/terms/page.tsx` following the same pattern as the privacy page.

**Same structure as privacy page but with terms namespace:**
- generateMetadata using `getTranslations({ locale, namespace: "legal.terms.meta" })`
- useTranslations("legal.terms") for page content
- alternates: `/en/terms` and `/he/terms`

**Terms sections (matching translation keys):**
- introduction, eligibility, accountTerms, platformUse, investorTerms, providerTerms, intellectualProperty, userContent, disclaimer, limitationOfLiability, indemnification, termination, governingLaw, disputeResolution, changes, contact

**Headings array:** Map each section key to its id (kebab-case) and translated heading text.

**Page layout:** Identical to privacy page:
- h1 title + lastUpdated
- Two-column layout with sticky TOC sidebar (desktop) and inline TOC (mobile)
- LegalSection for each section
- max-w-[75ch] for optimal readability
- Proper heading hierarchy (h1 > h2 > h3)

**Key differences from privacy:**
- governingLaw section may have subsections for NY law and Israeli law
- disputeResolution section should clearly format the arbitration clause
- investorTerms should emphasize disclaimer about not providing financial advice
- providerTerms should mention professional licensing requirements

Follow exact same import structure, layout patterns, and accessibility standards as the privacy page.
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm TypeScript compiles. Run `npx next build` and check that /en/terms and /he/terms routes are generated without errors.
  </verify>
  <done>
/terms page route exists, renders full terms of service with 16 sections, table of contents with jump links, Last Updated date, responsive typography, two-column desktop layout (sticky TOC sidebar), and proper generateMetadata with title/description/OpenGraph/alternates in both EN and HE. Follows identical layout pattern to /privacy page.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes without errors
2. `npx next build` completes successfully with /en/privacy, /he/privacy, /en/terms, /he/terms in output
3. Both pages use TableOfContents and LegalSection from @/components/legal
4. Both pages have generateMetadata with title, description, openGraph, and alternates
5. Content renders with proper heading hierarchy (single h1, h2 for sections, h3 for subsections)
6. Two-column layout on desktop (sticky TOC sidebar), single column with inline TOC on mobile
</verification>

<success_criteria>
- /privacy renders full privacy policy with 13 sections, scroll spy TOC, jump links, and Last Updated date
- /terms renders full terms of service with 16 sections, scroll spy TOC, jump links, and Last Updated date
- Both pages have correct metadata (title, description, OpenGraph) in EN and HE
- Both pages display correctly in English (LTR) and Hebrew (RTL) with logical properties
- Responsive typography with max-w-[75ch] for optimal line length
- WCAG-compliant heading hierarchy (single h1, h2 for sections, h3 for subsections)
- Satisfies requirements: LEGAL-01, LEGAL-02, LEGAL-03, LEGAL-04, LEGAL-05, LEGAL-06, LEGAL-07, LEGAL-08, LEGAL-09
</success_criteria>

<output>
After completion, create `.planning/phases/54-legal-and-pricing-pages/54-02-SUMMARY.md`
</output>
