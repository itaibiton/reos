---
phase: 29-css-logical-properties-migration
plan: 06
type: execute
wave: 2
depends_on: ["29-01", "29-02", "29-03"]
files_modified:
  - src/components/chat/ChatMessage.tsx
  - src/components/chat/ChatInput.tsx
  - src/components/chat/ChatThread.tsx
  - src/components/chat/ChatPane.tsx
  - src/components/chat/ChatParticipantList.tsx
  - src/components/chat/ChatModeToggle.tsx
  - src/components/chat/ConversationSelector.tsx
  - src/components/chat/DealSelector.tsx
  - src/components/chat/DealSelectorPopover.tsx
  - src/components/chat/DirectChatThread.tsx
  - src/components/chat/StackedAvatars.tsx
  - src/components/chat/GroupSettingsDialog.tsx
  - src/components/chat/NewConversationDialog.tsx
  - src/components/chat/ParticipantSelectorDialog.tsx
  - src/components/chat/AddMembersDialog.tsx
autonomous: true

must_haves:
  truths:
    - "Chat messages align correctly (own on end, others on start) in RTL"
    - "Chat input and controls position correctly in RTL"
    - "Participant lists and conversation selectors work in RTL"
    - "Stacked avatars overlap correctly in RTL"
  artifacts:
    - path: "src/components/chat/ChatMessage.tsx"
      provides: "RTL-compatible message bubbles"
      contains: "ms-|me-|text-start|text-end"
    - path: "src/components/chat/ConversationSelector.tsx"
      provides: "RTL-compatible conversation list"
      contains: "ms-|me-|ps-|pe-"
  key_links:
    - from: "src/components/chat/ChatThread.tsx"
      to: "src/components/chat/ChatMessage.tsx"
      via: "Message rendering"
      pattern: "ChatMessage"
---

<objective>
Migrate chat components to CSS logical properties

Purpose: Chat is a core feature of the platform. Message alignment, participant lists, and conversation selectors must work correctly in RTL for proper communication.

Output: All chat components use logical CSS properties.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-css-logical-properties-migration/29-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate core chat components</name>
  <files>
    src/components/chat/ChatMessage.tsx
    src/components/chat/ChatInput.tsx
    src/components/chat/ChatThread.tsx
    src/components/chat/ChatPane.tsx
    src/components/chat/ChatParticipantList.tsx
    src/components/chat/ChatModeToggle.tsx
    src/components/chat/DirectChatThread.tsx
  </files>
  <action>
Migrate ChatMessage.tsx (1 directional class):
- Note: Chat bubbles typically use flex justify-start/justify-end which is NOT directional
- If using `ml-auto`/`mr-auto` for own/other messages, convert to `ms-auto`/`me-auto`
- Check for text alignment classes and convert if needed

Migrate ChatInput.tsx (1 directional class):
- Convert any `pl-`/`pr-` to `ps-`/`pe-` for input padding
- Convert any `ml-`/`mr-` to `ms-`/`me-` for button spacing

Migrate ChatThread.tsx (1 directional class):
- Convert any scroll or spacing classes to logical

Migrate ChatPane.tsx (2 directional classes):
- Convert `ml-`/`mr-` to `ms-`/`me-` for pane margins
- Convert any border classes to logical

Migrate ChatParticipantList.tsx (3 directional classes):
- Convert `ml-`/`mr-` to `ms-`/`me-` for avatar/name spacing
- Convert `pl-`/`pr-` to `ps-`/`pe-` for list item padding

Migrate ChatModeToggle.tsx (1 directional class):
- Convert any margin/padding classes to logical

Migrate DirectChatThread.tsx (3 directional classes):
- Convert `ml-`/`mr-` to `ms-`/`me-` for message spacing
- Convert any positioning classes to logical
  </action>
  <verify>
Run `npm run build` - no TypeScript errors.
Grep check:
`grep -E "(ml-|mr-|pl-|pr-|left-[0-9]|right-[0-9])" src/components/chat/ChatMessage.tsx src/components/chat/ChatInput.tsx src/components/chat/ChatThread.tsx src/components/chat/ChatPane.tsx src/components/chat/ChatParticipantList.tsx src/components/chat/ChatModeToggle.tsx src/components/chat/DirectChatThread.tsx`
Should return empty.
  </verify>
  <done>
ChatMessage bubbles use logical alignment.
ChatInput and controls use logical padding.
ChatParticipantList uses logical spacing.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate chat dialogs and selectors</name>
  <files>
    src/components/chat/ConversationSelector.tsx
    src/components/chat/DealSelector.tsx
    src/components/chat/DealSelectorPopover.tsx
    src/components/chat/StackedAvatars.tsx
    src/components/chat/GroupSettingsDialog.tsx
    src/components/chat/NewConversationDialog.tsx
    src/components/chat/ParticipantSelectorDialog.tsx
    src/components/chat/AddMembersDialog.tsx
  </files>
  <action>
Migrate ConversationSelector.tsx (5 directional classes):
- Convert all `ml-`/`mr-` to `ms-`/`me-` for item spacing
- Convert `pl-`/`pr-` to `ps-`/`pe-` for list padding
- Add `rtl:space-x-reverse` if using horizontal space-x-*

Migrate DealSelector.tsx (3 directional classes):
- Convert `ml-`/`mr-` to `ms-`/`me-` for selector spacing
- Convert any positioning classes to logical

Migrate DealSelectorPopover.tsx (1 directional class):
- Convert any directional classes to logical

Migrate StackedAvatars.tsx (3 directional classes):
- Convert `-ml-*` negative margins to `-ms-*` for avatar overlap
- This is critical for correct avatar stacking direction in RTL

Migrate GroupSettingsDialog.tsx (1 directional class):
- Convert any directional classes to logical

Migrate NewConversationDialog.tsx (4 directional classes):
- Convert `ml-`/`mr-` to `ms-`/`me-` for form spacing
- Convert `pl-`/`pr-` to `ps-`/`pe-` for input padding

Migrate ParticipantSelectorDialog.tsx (3 directional classes):
- Convert `ml-`/`mr-` to `ms-`/`me-` for list item spacing
- Convert any checkbox label spacing to logical

Migrate AddMembersDialog.tsx (4 directional classes):
- Convert `ml-`/`mr-` to `ms-`/`me-` for member item spacing
- Convert `pl-`/`pr-` to `ps-`/`pe-` for content padding
  </action>
  <verify>
Run `npm run build` - no TypeScript errors.
Grep check:
`grep -E "(ml-|mr-|pl-|pr-|left-[0-9]|right-[0-9])" src/components/chat/ConversationSelector.tsx src/components/chat/DealSelector.tsx src/components/chat/DealSelectorPopover.tsx src/components/chat/StackedAvatars.tsx src/components/chat/GroupSettingsDialog.tsx src/components/chat/NewConversationDialog.tsx src/components/chat/ParticipantSelectorDialog.tsx src/components/chat/AddMembersDialog.tsx`
Should return empty.
  </verify>
  <done>
ConversationSelector (5 classes) fully migrated.
StackedAvatars overlap correctly in RTL with -ms-* margins.
All chat dialogs use logical spacing.
  </done>
</task>

</tasks>

<verification>
1. Build passes: `npm run build`
2. No physical directional classes in chat components
3. Chat messages display correctly in RTL (own on end, others on start)
4. Stacked avatars overlap correctly in RTL
</verification>

<success_criteria>
- [ ] ChatMessage uses logical alignment
- [ ] ConversationSelector (5 classes) fully migrated
- [ ] StackedAvatars (-ml-*) converted to -ms-* for correct RTL overlap
- [ ] All dialog components migrated
- [ ] Build passes with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/29-css-logical-properties-migration/29-06-SUMMARY.md`
</output>
