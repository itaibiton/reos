---
phase: 32-locale-formatting
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/[locale]/(app)/deals/page.tsx
  - src/app/[locale]/(app)/deals/[id]/page.tsx
  - src/app/[locale]/(app)/clients/page.tsx
  - src/app/[locale]/(app)/clients/[id]/page.tsx
  - src/app/[locale]/(app)/properties/[id]/page.tsx
  - src/app/[locale]/(app)/providers/[id]/page.tsx
  - src/app/[locale]/(app)/analytics/page.tsx
  - src/app/[locale]/(app)/dashboard/page.tsx
  - src/components/properties/SoldPropertiesTable.tsx
  - src/components/deals/InvestorQuestionnaireCard.tsx
autonomous: true

must_haves:
  truths:
    - "All application pages display dates and currency in locale-aware format"
    - "Deal pages show timestamps in user's locale"
    - "Client pages show dates in user's locale"
    - "Analytics page shows formatted numbers and dates"
  artifacts:
    - path: "src/app/[locale]/(app)/deals/page.tsx"
      provides: "Locale-aware deals list page"
      contains: "useFormatter"
    - path: "src/app/[locale]/(app)/analytics/page.tsx"
      provides: "Locale-aware analytics page"
      contains: "useFormatter"
    - path: "src/components/properties/SoldPropertiesTable.tsx"
      provides: "Locale-aware sold properties table"
      contains: "useFormatter"
  key_links:
    - from: "src/app/[locale]/(app)/deals/page.tsx"
      to: "next-intl"
      via: "useFormatter import"
      pattern: "useFormatter.*from.*next-intl"
---

<objective>
Migrate application pages and tables to use locale-aware formatting for dates and currency.

Purpose: Convert all page-level date and currency formatting to use useFormatter, ensuring consistent locale-aware display across deals, clients, properties, providers, and analytics pages.

Output: 10 files using useFormatter for dates and currency display in application pages.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v1.4-ROADMAP.md
@.planning/STATE.md
@.planning/phases/32-locale-formatting/32-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate deals and clients pages</name>
  <files>src/app/[locale]/(app)/deals/page.tsx, src/app/[locale]/(app)/deals/[id]/page.tsx, src/app/[locale]/(app)/clients/page.tsx, src/app/[locale]/(app)/clients/[id]/page.tsx</files>
  <action>
For each file:
1. Add import: `import { useFormatter } from "next-intl";`
2. Remove any local formatDate or formatUSD helper functions
3. Get formatter in component: `const format = useFormatter();`

Pattern for date formatting:
- Replace `formatDate(timestamp)` with `format.dateTime(new Date(timestamp), 'short')`
- For month/day only: `format.dateTime(new Date(timestamp), 'monthDay')`

Pattern for currency formatting:
- Replace `formatUSD(amount)` with:
  `format.number(amount, { style: 'currency', currency: 'USD', maximumFractionDigits: 0 })`

For deals/page.tsx and deals/[id]/page.tsx:
- Look for date display in deal cards/lists
- Look for price/value display

For clients/page.tsx and clients/[id]/page.tsx:
- Look for date display in client lists
- Look for any currency values
  </action>
  <verify>All files compile: `cd /Users/Kohelet/Code/REOS && npx tsc --noEmit src/app/[locale]/(app)/deals/page.tsx src/app/[locale]/(app)/deals/[id]/page.tsx src/app/[locale]/(app)/clients/page.tsx src/app/[locale]/(app)/clients/[id]/page.tsx`</verify>
  <done>Deal and client pages use useFormatter for dates and currency</done>
</task>

<task type="auto">
  <name>Task 2: Migrate property, provider, analytics, dashboard pages</name>
  <files>src/app/[locale]/(app)/properties/[id]/page.tsx, src/app/[locale]/(app)/providers/[id]/page.tsx, src/app/[locale]/(app)/analytics/page.tsx, src/app/[locale]/(app)/dashboard/page.tsx</files>
  <action>
For properties/[id]/page.tsx:
1. Add `import { useFormatter } from "next-intl";`
2. Remove local formatUSD/formatILS helpers
3. Replace currency formatting with useFormatter pattern
4. Replace any date formatting

For providers/[id]/page.tsx:
1. Add `import { useFormatter } from "next-intl";`
2. Remove local formatUSD/formatDate helpers
3. Replace formatting with useFormatter

For analytics/page.tsx:
1. Add `import { useFormatter } from "next-intl";`
2. Remove local formatUSD/formatDate helpers
3. Replace currency formatting
4. For chart data, format values before passing to chart OR use tickFormatter:
   - Pre-format data labels
   - Use format.number() for axis ticks if needed

For dashboard/page.tsx:
1. Check if any direct formatting exists (may delegate to child components)
2. Add useFormatter if needed for any local formatting
  </action>
  <verify>All files compile: `cd /Users/Kohelet/Code/REOS && npx tsc --noEmit src/app/[locale]/(app)/properties/[id]/page.tsx src/app/[locale]/(app)/providers/[id]/page.tsx src/app/[locale]/(app)/analytics/page.tsx src/app/[locale]/(app)/dashboard/page.tsx`</verify>
  <done>Property, provider, analytics, and dashboard pages use locale-aware formatting</done>
</task>

<task type="auto">
  <name>Task 3: Migrate SoldPropertiesTable and InvestorQuestionnaireCard</name>
  <files>src/components/properties/SoldPropertiesTable.tsx, src/components/deals/InvestorQuestionnaireCard.tsx</files>
  <action>
For SoldPropertiesTable.tsx:
1. Add `import { useFormatter } from "next-intl";`
2. Remove local formatUSD and formatDate helpers
3. Get formatter: `const format = useFormatter();`
4. Replace date formatting in table cells with:
   `format.dateTime(new Date(timestamp), 'short')`
5. Replace currency formatting with:
   `format.number(amount, { style: 'currency', currency: 'USD', maximumFractionDigits: 0 })`

For InvestorQuestionnaireCard.tsx:
1. Add `import { useFormatter } from "next-intl";`
2. Remove local formatUSD helper
3. Get formatter: `const format = useFormatter();`
4. Replace budget range formatting:
   `format.number(amount, { style: 'currency', currency: 'USD', maximumFractionDigits: 0 })`
  </action>
  <verify>Both files compile: `cd /Users/Kohelet/Code/REOS && npx tsc --noEmit src/components/properties/SoldPropertiesTable.tsx src/components/deals/InvestorQuestionnaireCard.tsx`</verify>
  <done>SoldPropertiesTable and InvestorQuestionnaireCard use locale-aware formatting</done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors: `npx tsc --noEmit`
2. No hardcoded formatUSD/formatDate helpers in pages: `grep -r "function formatUSD\|function formatDate" src/app/[locale]` returns nothing
3. useFormatter imported in all migrated files
</verification>

<success_criteria>
- All 4 deals/clients pages use useFormatter
- Property detail page uses useFormatter for currency
- Provider profile page uses useFormatter for currency and dates
- Analytics page uses useFormatter for charts and stats
- Dashboard page uses useFormatter where needed
- SoldPropertiesTable displays locale-aware dates and currency
- InvestorQuestionnaireCard displays locale-aware budget ranges
- No hardcoded "en-US" locale strings remain in migrated files
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/32-locale-formatting/32-03-SUMMARY.md`
</output>
