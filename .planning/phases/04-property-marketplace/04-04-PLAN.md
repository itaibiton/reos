---
phase: 04-property-marketplace
plan: 04
type: execute
---

<objective>
Integrate marketplace into navigation and verify complete flow.

Purpose: Make marketplace accessible from sidebar and test full user journey.
Output: Navigation updated, saved properties page, verified end-to-end flow.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-property-marketplace/04-01-SUMMARY.md
@.planning/phases/04-property-marketplace/04-02-SUMMARY.md
@.planning/phases/04-property-marketplace/04-03-SUMMARY.md

**Key files:**
@src/components/layout/Sidebar.tsx
@convex/favorites.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update sidebar navigation</name>
  <files>src/components/layout/Sidebar.tsx</files>
  <action>
Update Sidebar to include marketplace navigation:

Add nav items:
1. "Marketplace" - links to /properties (use Building or Home icon from Hugeicons)
2. "Saved Properties" - links to /properties/saved (use Heart icon)

Position in nav:
- Dashboard (existing)
- Marketplace (new)
- Saved Properties (new)
- Settings (existing)

Use consistent icon style (Hugeicons, strokeWidth 1.5).
Highlight active route using pathname matching.
  </action>
  <verify>Sidebar shows new nav items, links work</verify>
  <done>Marketplace and Saved Properties appear in sidebar navigation</done>
</task>

<task type="auto">
  <name>Task 2: Create saved properties page</name>
  <files>src/app/(app)/properties/saved/page.tsx</files>
  <action>
Create saved properties page at /properties/saved:

**Header:**
- "Saved Properties" title
- Count of saved properties

**Content:**
- Use listMyFavorites query to get saved properties
- Display in same grid layout as marketplace (1/2/3 columns)
- Reuse PropertyCard component

**Empty state:**
- If no saved properties, show friendly message
- "Browse Marketplace" CTA button linking to /properties

**Loading state:**
- Skeleton cards while loading
  </action>
  <verify>npm run build succeeds, page shows saved properties</verify>
  <done>Saved properties page displays user's favorited properties</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete property marketplace with listings, details, and favorites</what-built>
  <how-to-verify>
    1. Run: npm run dev (and npx convex dev)

    **Test Property Creation:**
    2. Navigate to /properties/new
    3. Fill out property form with test data:
       - Title: "Modern Tel Aviv Apartment"
       - City: Tel Aviv
       - Price: 500000 USD
       - Add some metrics (ROI, etc.)
    4. Submit and verify success toast

    **Test Marketplace:**
    5. Navigate to /properties
    6. Verify property card displays with correct info
    7. Check responsive layout (resize window)

    **Test Property Detail:**
    8. Click on property card
    9. Verify detail page shows all information
    10. Check two-column layout on desktop

    **Test Favorites:**
    11. Click save/heart button on detail page
    12. Verify button state changes (filled heart)
    13. Navigate to /properties/saved
    14. Verify property appears in saved list
    15. Unsave and verify it disappears

    **Test Navigation:**
    16. Check sidebar shows Marketplace and Saved Properties
    17. Verify all links work correctly
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Sidebar has Marketplace and Saved Properties links
- [ ] Saved properties page works
- [ ] Full flow tested end-to-end
- [ ] `npm run build` succeeds
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Human verification approved
- Phase 4: Property Marketplace complete
</success_criteria>

<output>
After completion, create `.planning/phases/04-property-marketplace/04-04-SUMMARY.md`:

# Phase 4 Plan 4: Final Integration Summary

**[One-liner summarizing what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

Phase 4 complete, ready for Phase 5: Smart Search
</output>
