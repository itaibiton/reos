---
phase: 07-dashboards
plan: 02
type: execute
---

<objective>
Create role-specific investor dashboard with personalized stats and property recommendations.

Purpose: Transform generic dashboard into personalized investor experience with relevant metrics and recommendations.
Output: Dashboard page showing investor-specific stats, deals summary, and recommended properties.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan in this phase:
@.planning/phases/07-dashboards/07-01-PLAN.md

# Relevant source files:
@src/app/(app)/dashboard/page.tsx
@src/components/dashboard/DashboardMap.tsx
@convex/dashboard.ts

**Tech stack available:** Next.js 16, Convex, Clerk auth, Shadcn/ui, Hugeicons
**Established patterns:**
- Dashboard uses two-column layout (stats left, map right)
- Stats cards with icon + value + label pattern
- PropertyCard component for property display
- Skeleton loaders matching data structure
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create investor dashboard components</name>
  <files>src/components/dashboard/InvestorDashboard.tsx, src/components/dashboard/RecommendedProperties.tsx</files>
  <action>
Create InvestorDashboard.tsx component that:
1. Uses useQuery to fetch dashboard.getStats
2. Shows investor-specific stat cards:
   - Active Deals (with Agreement icon, primary color)
   - Completed Deals (with CheckmarkCircle icon, green)
   - Saved Properties (with Favourite icon, red)
   - Pending Requests (with Clock icon, yellow)
3. Shows "My Deals" section with 3 most recent active deals (use deals.list with limit)
4. Links to /deals for full list
5. Quick actions: Browse Properties, View Saved, View Deals

Create RecommendedProperties.tsx component that:
1. Uses useQuery to fetch dashboard.getRecommendedProperties
2. Renders grid of recommended PropertyCards (2 cols on md, 3 on lg)
3. Shows match score badge on each card (e.g., "92% match")
4. Empty state: "Complete your investor profile for personalized recommendations" with link to /settings
5. Loading state: 3 skeleton cards

Pattern: Follow existing PropertyCard usage from marketplace. Use Card, Badge, Skeleton from Shadcn.
  </action>
  <verify>npm run build passes, components render without errors</verify>
  <done>InvestorDashboard and RecommendedProperties components created with stats and recommendations</done>
</task>

<task type="auto">
  <name>Task 2: Update dashboard page with role routing</name>
  <files>src/app/(app)/dashboard/page.tsx</files>
  <action>
Refactor dashboard page to render role-specific content:

1. Get effectiveRole from useCurrentUser
2. For investor role:
   - Left column: InvestorDashboard component
   - Below stats: RecommendedProperties section
   - Right column: DashboardMap (keep existing)
3. For service provider roles (broker, mortgage_advisor, lawyer):
   - Keep current generic layout for now (Plan 03 will enhance)
   - Add comment marking where provider dashboard will go
4. For admin (no viewingAsRole):
   - Show platform-wide stats (keep existing logic)

Maintain responsive two-column layout. Keep map on right side for all roles.
Keep existing skeleton loader but add role awareness.
  </action>
  <verify>npm run build passes, dashboard shows investor content when logged in as investor</verify>
  <done>Dashboard page routes to InvestorDashboard for investor users, keeps generic for others</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Role-specific investor dashboard with personalized stats and property recommendations</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Log in as investor (or admin viewing as investor)
    3. Visit: http://localhost:3000/dashboard
    4. Verify investor stats show (Active Deals, Completed, Saved, Pending)
    5. Verify "My Deals" section shows recent deals or empty state
    6. Verify "Recommended Properties" section shows properties with match scores
    7. Test skeleton loading states (refresh page)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Investor dashboard shows personalized stats
- [ ] Recommended properties display with match scores
- [ ] Role routing works (investor sees investor dash, others see generic)
</verification>

<success_criteria>

- InvestorDashboard and RecommendedProperties components exist
- Dashboard page shows role-appropriate content
- Stats reflect actual user data from Convex
- Recommendations show personalized properties
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-dashboards/07-02-SUMMARY.md`
</output>
