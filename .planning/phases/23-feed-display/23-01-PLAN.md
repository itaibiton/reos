---
phase: 23-feed-display
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/feed/PostCard.tsx
  - src/components/feed/PropertyPostCard.tsx
  - src/components/feed/ServiceRequestPostCard.tsx
  - src/components/feed/DiscussionPostCard.tsx
  - src/components/feed/PostCardSkeleton.tsx
  - src/components/feed/index.ts
autonomous: true

must_haves:
  truths:
    - "Property posts display property image, title, price, and author info"
    - "Service request posts display service type badge and request content"
    - "Discussion posts display text content with author info"
    - "All post cards show like/comment/save counts"
    - "All post cards show relative timestamp (e.g., '2 hours ago')"
  artifacts:
    - path: "src/components/feed/PostCard.tsx"
      provides: "Main PostCard component that delegates to type-specific cards"
      exports: ["PostCard"]
    - path: "src/components/feed/PropertyPostCard.tsx"
      provides: "Card for property_listing posts with image and property details"
      exports: ["PropertyPostCard"]
    - path: "src/components/feed/ServiceRequestPostCard.tsx"
      provides: "Card for service_request posts with service type badge"
      exports: ["ServiceRequestPostCard"]
    - path: "src/components/feed/DiscussionPostCard.tsx"
      provides: "Card for discussion posts (text-only)"
      exports: ["DiscussionPostCard"]
    - path: "src/components/feed/PostCardSkeleton.tsx"
      provides: "Loading skeleton matching card structure"
      exports: ["PostCardSkeleton"]
  key_links:
    - from: "src/components/feed/PostCard.tsx"
      to: "PropertyPostCard, ServiceRequestPostCard, DiscussionPostCard"
      via: "switch on post.postType"
      pattern: "switch.*postType"
---

<objective>
Create post card components for the three post types (property listing, service request, discussion) with consistent author header, engagement footer, and type-specific content.

Purpose: Post cards are the visual building blocks of the feed - each post type needs appropriate display of its unique content while sharing common elements (author, timestamp, engagement counts).

Output: 5 new components in src/components/feed/ with barrel export updates
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@convex/posts.ts - enrichPost returns authorName, authorImageUrl, authorRole, property (for property_listing)
@src/components/properties/PropertyCard.tsx - existing card pattern with image, badges, content sections
@src/components/feed/index.ts - barrel export pattern
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create base post card components with author header and engagement footer</name>
  <files>
    src/components/feed/PostCard.tsx
    src/components/feed/PropertyPostCard.tsx
    src/components/feed/ServiceRequestPostCard.tsx
    src/components/feed/DiscussionPostCard.tsx
  </files>
  <action>
Create 4 post card components following existing PropertyCard patterns:

**PostCard.tsx (dispatcher):**
- Accept enriched post from globalFeed query (includes authorName, authorImageUrl, authorRole, property)
- Switch on `post.postType` to render PropertyPostCard, ServiceRequestPostCard, or DiscussionPostCard
- Export the EnrichedPost type for use in other components

**Common elements for all cards (implement in each type-specific card):**

1. **Author Header** (shared pattern, implement in each card):
   - Avatar (32x32, use Avatar component with AvatarFallback showing initials)
   - Author name (font-medium)
   - Role badge (small, secondary variant, e.g., "Investor", "Broker")
   - Relative timestamp using formatDistanceToNow from date-fns (add "ago" suffix)
   - Layout: flex items-center gap-3

2. **Engagement Footer** (shared pattern):
   - Like count with FavouriteIcon from hugeicons
   - Comment count with Comment01Icon
   - Save count with BookmarkAdd01Icon
   - Layout: flex items-center gap-4 text-sm text-muted-foreground pt-3 border-t

**PropertyPostCard.tsx:**
- Card with p-0 for edge-to-edge image
- Property image (h-48) from post.property.featuredImage (or placeholder icon)
- Property title, city overlaid on image or below
- Property price formatted as compact USD ($1.5M, $500K pattern)
- Post content below property info (caption text)
- Author header and engagement footer

**ServiceRequestPostCard.tsx:**
- Card with padding throughout
- Service type badge at top (Broker/Mortgage Advisor/Lawyer) with UserMultiple02Icon
- Badge color: default variant
- Post content as main body (what they're looking for)
- Author header and engagement footer

**DiscussionPostCard.tsx:**
- Card with padding throughout
- Comment01Icon indicator (small, muted)
- Post content as main body
- Author header and engagement footer
- Simplest card - text-focused

Use Shadcn Card, Avatar, Badge components. Use Hugeicons for icons.
Role labels: investor -> "Investor", broker -> "Broker", mortgage_advisor -> "Mortgage Advisor", lawyer -> "Lawyer"
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit`
Files exist with correct exports
  </verify>
  <done>
All 4 post card components created with proper typing and consistent visual structure
  </done>
</task>

<task type="auto">
  <name>Task 2: Create PostCardSkeleton and update barrel exports</name>
  <files>
    src/components/feed/PostCardSkeleton.tsx
    src/components/feed/index.ts
  </files>
  <action>
**PostCardSkeleton.tsx:**
Create a loading skeleton that matches the general post card structure:
- Skeleton for author header: circle (32x32) + two lines for name/role
- Skeleton for content area: 3 lines of varying widths (full, 3/4, 1/2)
- Skeleton for engagement footer: 3 small blocks for counts
- Use Shadcn Skeleton component
- Card wrapper with padding

**index.ts:**
Update barrel exports to include all new components:
```typescript
export { CreatePostDialog } from "./CreatePostDialog";
export { PropertySelector } from "./PropertySelector";
export { PostCard } from "./PostCard";
export { PropertyPostCard } from "./PropertyPostCard";
export { ServiceRequestPostCard } from "./ServiceRequestPostCard";
export { DiscussionPostCard } from "./DiscussionPostCard";
export { PostCardSkeleton } from "./PostCardSkeleton";
```

Also export the EnrichedPost type from PostCard.tsx for use in the feed page.
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit`
All exports resolve: `grep -E "export" src/components/feed/index.ts`
  </verify>
  <done>
PostCardSkeleton created, all feed components properly exported via barrel
  </done>
</task>

</tasks>

<verification>
- All 5 new component files exist in src/components/feed/
- TypeScript compiles without errors
- Components use Shadcn Card, Avatar, Badge, Skeleton
- Components use Hugeicons icons (not lucide-react except via Shadcn)
- Barrel export includes all new components
</verification>

<success_criteria>
- PropertyPostCard renders property image, title, price, caption, author, engagement
- ServiceRequestPostCard renders service type badge, content, author, engagement
- DiscussionPostCard renders content, author, engagement
- PostCard dispatches to correct type-specific card based on postType
- PostCardSkeleton provides loading state matching card structure
- All components exported via @/components/feed barrel
</success_criteria>

<output>
After completion, create `.planning/phases/23-feed-display/23-01-SUMMARY.md`
</output>
