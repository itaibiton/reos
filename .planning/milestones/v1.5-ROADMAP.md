# Roadmap: REOS v1.5 Mobile Responsive & Header Redesign

## Overview

Transforming REOS into a mobile-first experience with proper viewport handling, theme switching, role-based bottom navigation, and a consolidated header dropdown. The implementation follows strict dependency order: foundation CSS patterns first, then theme system wiring, then mobile navigation infrastructure, header redesign, and finally responsive layout polish across existing pages.

## Milestone Goal

Users can comfortably use REOS on mobile devices with proper safe-area handling, easy theme switching, role-appropriate bottom navigation, and a clean unified header that consolidates notifications, settings, and sign out.

## Phases

### Phase 35: Mobile Foundation

**Goal:** App uses proper viewport units and safe-area handling for mobile devices.

**Dependencies:** None (foundational)

**Requirements:**
- FND-01: Viewport uses 100dvh for full-height layouts (not 100vh)
- FND-02: CSS env() safe-area-inset variables configured
- FND-03: ThemeProvider properly wraps application
- FND-04: useIsMobile() hook used consistently for responsive behavior

**Plans:** 2 plans

Plans:
- [x] 35-01-PLAN.md — Configure viewport meta, ThemeProvider, safe-area CSS utilities
- [x] 35-02-PLAN.md — Convert 100vh/min-h-screen to 100dvh/min-h-dvh

**Success Criteria:**
1. User on iOS Safari sees full-height layouts without address bar overlap (100dvh working)
2. User on iPhone with notch sees content not hidden behind home indicator (safe-area-inset-bottom working)
3. App root wrapped with next-themes ThemeProvider with proper configuration
4. useIsMobile() hook returns true for viewports under 768px, false otherwise

---

### Phase 36: Theme System

**Goal:** Users can switch between light, dark, and system themes with smooth transitions.

**Dependencies:** Phase 35 (ThemeProvider must be configured)

**Requirements:**
- THM-01: Settings tab contains Light/Dark/System toggle
- THM-02: Theme preference persists across sessions (localStorage)
- THM-03: No theme flash on page load (proper hydration)
- THM-04: System option respects OS dark mode preference
- THM-05: Theme transition animates smoothly

**Plans:** 1 plan

Plans:
- [x] 36-01-PLAN.md — Create ThemeSwitcher component, enable transitions, add test page

**Success Criteria:**
1. User can select Light, Dark, or System theme from a toggle control
2. User refreshes page and sees previously selected theme (no flash to wrong theme)
3. User with OS set to dark mode selects "System" and sees dark theme applied
4. User switching themes sees smooth color transition (not instant snap)
5. Theme preference survives browser restart (localStorage persistence)

---

### Phase 37: Mobile Navigation

**Goal:** Mobile users see role-specific bottom tab bar instead of sidebar.

**Dependencies:** Phase 35 (safe-area handling required for tab bar positioning)

**Requirements:**
- NAV-01: App displays bottom tab bar on mobile (<768px) with 5 tabs
- NAV-02: Tab bar shows role-specific tabs (investors: Properties, Feed, Chat, Deals, Profile)
- NAV-03: Tab bar shows role-specific tabs (providers: Dashboard, Clients, Chat, Feed, Profile)
- NAV-04: Active tab shows visual indicator (filled icon, color highlight)
- NAV-05: Tabs display badge for unread counts (notifications, messages)
- NAV-06: Tab bar respects iOS safe area insets (no content behind home indicator)
- NAV-07: Tab transitions animate smoothly with Framer Motion
- NAV-08: Sidebar is hidden on mobile, replaced by bottom tabs

**Plans:** 3 plans

Plans:
- [x] 37-01-PLAN.md — Add getMobileTabsForRole function to navigation.ts
- [x] 37-02-PLAN.md — Refactor MobileBottomNav with role-based tabs, animations, badges
- [x] 37-03-PLAN.md — Integrate MobileBottomNav into AppShell layout

**Success Criteria:**
1. User on mobile (<768px) sees 5-tab bottom bar instead of sidebar
2. Investor sees tabs: Properties, Feed, Chat, Deals, Profile
3. Provider (broker/lawyer/mortgage_advisor) sees tabs: Dashboard, Clients, Chat, Feed, Profile
4. User tapping tab sees visual feedback (filled icon, highlight color)
5. User with unread messages sees badge count on Chat tab
6. User on iPhone sees tab bar above home indicator (safe area respected)
7. User navigating between tabs sees smooth animated transition

---

### Phase 38: Header Redesign

**Goal:** Header consolidates notifications, settings, and sign out into a single avatar dropdown.

**Dependencies:** Phase 36 (theme toggle needed in settings tab), Phase 37 (mobile breakpoint behavior)

**Requirements:**
- HDR-01: Header shows search icon on mobile that expands to full search input on tap
- HDR-02: Header shows single avatar dropdown button on right side
- HDR-03: Dropdown contains Notifications tab with unread items
- HDR-04: Dropdown contains Settings tab with theme and language switches
- HDR-05: Dropdown shows Sign Out button at bottom
- HDR-06: Dropdown trigger shows unread notification badge
- HDR-07: Breadcrumbs hidden on mobile, shown on desktop
- HDR-08: Search expansion animates smoothly
- HDR-09: Notifications grouped by type in dropdown
- HDR-10: Custom UI built with Clerk functions (no Clerk components)

**Plans:** 3 plans

Plans:
- [x] 38-01-PLAN.md — Create AvatarDropdown with NotificationsTab and SettingsTab
- [x] 38-02-PLAN.md — Create MobileSearchExpander with animated expansion
- [x] 38-03-PLAN.md — Integrate header components into AppShell and Header

**Success Criteria:**
1. User on mobile sees search icon that expands to full-width input when tapped
2. User sees single avatar button on right side of header (not separate notification/settings buttons)
3. User clicking avatar sees dropdown with Notifications and Settings tabs
4. User in Settings tab can toggle theme (Light/Dark/System) and language (English/Hebrew)
5. User sees Sign Out button at bottom of dropdown
6. User with unread notifications sees badge on avatar button
7. User on mobile does not see breadcrumbs; user on desktop sees breadcrumbs
8. User tapping search icon sees smooth animated expansion
9. Notifications in dropdown are grouped by type (messages, deals, follows, etc.)
10. No Clerk UserButton visible - all auth UI is custom-built

---

### Phase 39: Responsive Layouts

**Goal:** All existing pages render optimally on mobile with proper touch targets and patterns.

**Dependencies:** Phase 37 (mobile navigation provides layout context), Phase 38 (header provides search/navigation)

**Requirements:**
- RSP-01: Property cards stack vertically (full-width) on mobile
- RSP-02: All form inputs are full-width on mobile
- RSP-03: Modals display as bottom sheets on mobile
- RSP-04: Touch targets are minimum 44px for all interactive elements
- RSP-05: Pull-to-refresh available on feed pages
- RSP-06: Desktop layouts remain unchanged (no regressions)

**Plans:** 3 plans

Plans:
- [ ] 39-01-PLAN.md — Create ResponsiveDialog component, convert 7 dialogs to bottom sheets
- [ ] 39-02-PLAN.md — Update property cards and form grids for mobile-first layout
- [ ] 39-03-PLAN.md — Add touch-target button sizes and pull-to-refresh on feed

**Success Criteria:**
1. User on mobile sees property cards stacked full-width (not side-by-side grid)
2. User on mobile sees all form inputs at full width (not narrow inline inputs)
3. User on mobile tapping action that opens modal sees it slide up from bottom (bottom sheet)
4. User can tap all buttons, links, and interactive elements without precision issues (44px minimum)
5. User on feed page can pull down to refresh content
6. User on desktop sees unchanged layouts (no mobile-only changes affecting desktop)

---

## Progress

| Phase | Name | Requirements | Plans | Status |
|-------|------|--------------|-------|--------|
| 35 | Mobile Foundation | FND-01, FND-02, FND-03, FND-04 | 2/2 | Complete |
| 36 | Theme System | THM-01, THM-02, THM-03, THM-04, THM-05 | 1/1 | Complete |
| 37 | Mobile Navigation | NAV-01, NAV-02, NAV-03, NAV-04, NAV-05, NAV-06, NAV-07, NAV-08 | 3/3 | Complete |
| 38 | Header Redesign | HDR-01 to HDR-10 | 3/3 | Complete |
| 39 | Responsive Layouts | RSP-01, RSP-02, RSP-03, RSP-04, RSP-05, RSP-06 | 3 | Pending |

## Coverage

| Requirement | Phase | Description |
|-------------|-------|-------------|
| FND-01 | 35 | 100dvh viewport units |
| FND-02 | 35 | CSS safe-area-inset variables |
| FND-03 | 35 | ThemeProvider configuration |
| FND-04 | 35 | useIsMobile() hook consistency |
| THM-01 | 36 | Theme toggle in settings |
| THM-02 | 36 | Theme persistence (localStorage) |
| THM-03 | 36 | No theme flash on load |
| THM-04 | 36 | System theme respects OS |
| THM-05 | 36 | Smooth theme transitions |
| NAV-01 | 37 | Bottom tab bar on mobile |
| NAV-02 | 37 | Investor role tabs |
| NAV-03 | 37 | Provider role tabs |
| NAV-04 | 37 | Active tab indicator |
| NAV-05 | 37 | Unread badge on tabs |
| NAV-06 | 37 | iOS safe area for tab bar |
| NAV-07 | 37 | Framer Motion tab transitions |
| NAV-08 | 37 | Hide sidebar on mobile |
| HDR-01 | 38 | Mobile search icon expansion |
| HDR-02 | 38 | Single avatar dropdown |
| HDR-03 | 38 | Notifications tab in dropdown |
| HDR-04 | 38 | Settings tab in dropdown |
| HDR-05 | 38 | Sign Out in dropdown |
| HDR-06 | 38 | Unread badge on trigger |
| HDR-07 | 38 | Breadcrumbs hidden on mobile |
| HDR-08 | 38 | Animated search expansion |
| HDR-09 | 38 | Grouped notifications |
| HDR-10 | 38 | Custom UI (no Clerk components) |
| RSP-01 | 39 | Full-width property cards |
| RSP-02 | 39 | Full-width form inputs |
| RSP-03 | 39 | Bottom sheet modals |
| RSP-04 | 39 | 44px touch targets |
| RSP-05 | 39 | Pull-to-refresh on feed |
| RSP-06 | 39 | Desktop layout preservation |

**Total:** 32/32 requirements mapped

---

*Created: 2026-01-21*
*Milestone: v1.5 Mobile Responsive & Header Redesign*
