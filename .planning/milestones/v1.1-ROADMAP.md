# Milestone v1.1: Investor Onboarding

**Status:** SHIPPED 2026-01-18
**Phases:** 9-15
**Total Plans:** 8

## Overview

Enhanced investor onboarding with a comprehensive questionnaire wizard that captures investment preferences, property criteria, and service needs. Providers can view investor profiles to better serve their clients.

## Phases

### Phase 9: Onboarding Gate & State

**Goal**: Create onboarding gate with questionnaire state management
**Depends on**: v1.0 complete
**Plans**: 1 plan

Plans:
- [x] 09-01: Onboarding gate + questionnaire schema + state management

**Details:**
Role-aware onboarding: investors get onboardingStep=1, service providers complete immediately. investorQuestionnaires table stores draft answers with status field (draft/complete). Gate logic in layout.tsx checks role + onboardingComplete for redirect decisions.

### Phase 10: Questionnaire UI Framework

**Goal**: Create conversational questionnaire wizard component
**Depends on**: Phase 9
**Plans**: 1 plan

Plans:
- [x] 10-01: QuestionnaireWizard + QuestionBubble + TypeWriter components

**Details:**
QuestionnaireWizard with 1-based step indexing. Conversational UI with QuestionBubble (assistant bubble) and AnswerArea (user input). Tailwind animate-in utilities for animations. Keyboard navigation: Enter to continue, Escape to skip.

### Phase 11: Questionnaire Content - Part 1

**Goal**: Implement first 5 questionnaire steps (citizenship through investment type)
**Depends on**: Phase 10
**Plans**: 1 plan

Plans:
- [x] 11-01: CitizenshipStep, ResidencyStep, ExperienceStep, OwnershipStep, InvestmentTypeStep

**Details:**
Step components follow value/onChange props pattern. Local useState for UI, Convex sync on step change. Draft restoration via useEffect on questionnaire load.

### Phase 12: Questionnaire Content - Part 2

**Goal**: Implement budget, timeline, goals, yield, and financing steps
**Depends on**: Phase 11
**Plans**: 1 plan

Plans:
- [x] 12-01: BudgetStep, HorizonStep, GoalsStep, YieldStep, FinancingStep

**Details:**
BudgetStep uses separate min/max props with individual onChange handlers. GoalsStep uses checkbox multi-select with array state. Currency formatting uses toLocaleString for display.

### Phase 13: Property Preferences & Location

**Goal**: Implement property type, size, location, and amenities steps
**Depends on**: Phase 12
**Plans**: 1 plan

Plans:
- [x] 13-01: PropertyTypeStep, PropertySizeStep, LocationStep, AmenitiesStep

**Details:**
PropertySizeStep uses 4 individual onChange handlers (bedrooms min/max, area min/max). LocationStep uses 2-column grid for 15 Israeli cities. AmenitiesStep uses 3-column grid for compact display of 15 amenities.

### Phase 14: AI Preferences & Service Selection

**Goal**: Implement timeline, preferences, and services steps
**Depends on**: Phase 13
**Plans**: 1 plan

Plans:
- [x] 14-01: TimelineStep, AdditionalPreferencesStep, ServicesStep

**Details:**
TimelineStep uses radio single-select with 4 purchase timeline options. AdditionalPreferencesStep uses Textarea with 2000 char limit and character count. ServicesStep uses checkbox multi-select for broker/mortgage_advisor/lawyer.

### Phase 15: Profile Display & Edit

**Goal**: Display investor questionnaire to providers, enable profile editing
**Depends on**: Phase 14
**Plans**: 2 plans

Plans:
- [x] 15-01: InvestorQuestionnaireCard + getByInvestorId query
- [x] 15-02: Edit questionnaire page + ProfileCompletenessCard

**Details:**
getByInvestorId access control: self-access OR provider assigned to shared deal. InvestorQuestionnaireCard shows to providers only. QuestionnaireWizard extended with editMode prop. Completeness calculation uses 15 required fields, excludes optional (bedrooms/area/amenities).

---

## Milestone Summary

**Key Components Created:**
- QuestionnaireWizard - Main wizard controller with step navigation
- QuestionBubble - Conversational assistant message bubble
- TypeWriter - Animated text typing effect
- 17 step components (CitizenshipStep through ServicesStep)
- InvestorQuestionnaireCard - Profile display for providers
- ProfileCompletenessCard - Completeness indicator with edit link

**Key Decisions:**
- 1-based step indexing to match Convex currentStep field
- Conversational UI pattern (assistant asks, user answers)
- Local useState for UI responsiveness, Convex sync on step change
- 15 required fields for completeness calculation
- editMode prop on wizard (hides skip, shows "Save Changes")
- Provider access control via deal assignments

**Issues Resolved:**
- Role guards added to investor-only pages to prevent non-investors accessing
- Service provider onboarding status fixed in seed script

**Technical Debt Incurred:**
- Label mappings kept inline in InvestorQuestionnaireCard (could be shared constants)

---

*For current project status, see .planning/ROADMAP.md*
